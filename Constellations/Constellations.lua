-- ========== НАСТРОЙКИ ==========
local CONSTELLATIONS_DATA = {
    ["Аристократа"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\aristocrat-1.blp",
        abilities = {
            { 
                name = "Аристократичность", 
                role = "ДД", 
                spellID = 374893,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_spiritamulet_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь ваш критический урон и критический урон ваших питомцев повышается на 3%."
            },
            { 
                name = "Богатое наследие", 
                role = "Танк", 
                spellID = 374894,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_spiritsilence_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВ бою, каждые 15 сек., вы и ваши питомцы получаете эффект поглощения урона, равный 4% от вашего максимального запаса здоровья, на 15 сек. Этот эффект не суммируется. В PvP он на 50% менее эффективен."
            },
            { 
                name = "Секрет рода", 
                role = "Хил", 
                spellID = 374896,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_spirittranquility_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nНаходясь в бою, каждые 30 сек. вы призываете 3 магические сферы. Каждая подобранная сфера повышает ваше исцеление и исцеление ваших питомцев на 1%. Сферы исчезают через 8 сек., а эффект усиления исцеления действует 40 сек."
            },
            { 
                name = "Тенета элегантности", 
                role = "PVE", 
                spellID = 375120,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_spellcasting_blue.blp",
                description = "Мгновенное действие | Восстановление: 1.5 мин.\nПри активации вы и ваши питомцы получаете невосприимчивость к эффектам прерывания и немоты на 3 сек. Помимо этого, ваш наносимый урон и создаваемое исцеление повышаются на 12%, а получаемый урон снижается на 6% на 18 сек. Эффект ослабевает на 50% спустя 9 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Надменный взор", 
                role = "PVP", 
                spellID = 375024,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_warlock28_border.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации ваша способность обнаруживать незаметность и невидимость повышается на 8 сек.\n\nПока эффект активен, исходящий урон и исцеление для вас и ваших питомцев увеличивается на 2%. Дополнительно, этот бонус возрастает на 2% за каждые 10% отсутствующего здоровья, вплоть до максимального значения в 12%.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Быка"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\bull-1.blp",
        abilities = {
            { 
                name = "Дуэль", 
                role = "ДД", 
                spellID = 374806,
                icon = "Interface\\AddOns\\Constellations\\Textures\\crossingswords_colorsred.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nКаждый раз, когда вы атакуете противника, вы втягиваете его в смертельную схватку: ваш урон и урон ваших питомцев по этой цели увеличивается на 2%, а весь урон, получаемый вами и вашими питомцами от этой цели, снижается на 1%. Эффект действует на одну цель."
            },
            { 
                name = "Бычье могущество", 
                role = "Танк", 
                spellID = 374808,
                icon = "Interface\\AddOns\\Constellations\\Textures\\frenzy_redorange.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри вступлении в бой весь получаемый вами и вашими питомцами урон снижается на 3% на 15 сек. После этого эффект будет срабатывать каждые 20 сек."
            },
            { 
                name = "Мощь природы", 
                role = "Хил", 
                spellID = 374810,
                icon = "Interface\\AddOns\\Constellations\\Textures\\staffofnegation_green.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nЭффективность вашего критического исцеления и критического исцеления ваших питомцев повышается на 3%."
            },
            { 
                name = "Сила Матери-Земли", 
                role = "PVE", 
                spellID = 375056,
                icon = "Interface\\AddOns\\Constellations\\Textures\\liquidstone_poison.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы и ваши питомцы получаете на 2% меньше урона, а наносимый урон и исходящее исцеление повышаются на 9%. Ваше тело насыщается силой Матери-Земли на 10 сек., преобразуя 15% всего получаемого урона в эффект периодического урона, который равными долями наносится в виде урона от сил природы раз в 2 сек. в течение 6 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Бычья поступь", 
                role = "PVP", 
                spellID = 374994,
                icon = "Interface\\AddOns\\Constellations\\Textures\\boolstomp.blp",
                description = "Применение: 0.5 сек. | Восстановление: 2 мин.\nПри активации вы оглушаете до 5 противников в радиусе 8 м. на 2 сек. Оглушенные противники получают на 5% больше урона в течение 4 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Варвара"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\barbarian-1.blp",
        abilities = {
            { 
                name = "Критическая сила", 
                role = "ДД", 
                spellID = 374796,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_calltoarmsred.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона противнику, чей запас здоровья ниже 75%, ваш критический урон и критический урон ваших питомцев повышается на 4%. После активации этот эффект действует 5 сек."
            },
            { 
                name = "Стойкость варвара", 
                role = "Танк", 
                spellID = 374798,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_d3calloftheancients.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаш запас здоровья и запас здоровья ваших питомцев увеличивается на 3%."
            },
            { 
                name = "Сила крови", 
                role = "Хил", 
                spellID = 374799,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_hole_red.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nСоздаваемое вами и вашими питомцами исцеление увеличивается на 2%."
            },
            { 
                name = "Варварский ритуал", 
                role = "PVE", 
                spellID = 375050,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_warriorritual.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри активации вы на 10 сек. впадаете в безудержную ярость. Во время действия этого эффект аваша сила атаки или сила заклинаний (выбирается наибольший показатель) будет повышена на 7%. Этот эффект также распространяется на ваших питомцев, но с 60% эффективностью.\n\nПока эффект активен, вы и ваши питомцы получаете на 3% меньше урона, а скорость передвижения повышается на 20%.\n\nЭффект \"Демонического союза\" у чернокнижника не учитывает силу заклинаний, предоставляемую этим навыком, при расчете финального значения бонуса.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Безудержная ярость", 
                role = "PVP", 
                spellID = 374988,
                icon = "Interface\\Icons\\spell_winston_rage",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации ваши физические атаки ближнего и дальнего боя, атакующие заклинания, а также заклинания и атаки ваших питомцев будут дополнительно наносить 10% урона в виде физического урона, одновременно восполняя ваше здоровье в том же объеме. Магические атаки будут наносить урон в виде урона от магии огня. Исцеляющие заклинания будут дополнительно восполнять 10% здоровья. Эффект длится 10 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Волка"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\wolf-1.blp",
        abilities = {
            { 
                name = "Волчья тень", 
                role = "ДД", 
                spellID = 374889,
                icon = "Interface\\AddOns\\Constellations\\Textures\\wolfshadow.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь наносимый вами и вашими питомцами урон повышается на 2%."
            },
            { 
                name = "Волк в овечьей шкуре", 
                role = "Танк", 
                spellID = 374890,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_213_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь урон от заклинаний прямого действия, получаемый вами и вашими питомцами, снижается на 4%."
            },
            { 
                name = "Волк волку - волк", 
                role = "Хил", 
                spellID = 374891,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_102_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\n5% вашего избыточного исцеления и избыточного исцеления ваших питомцев теперь перенаправляется к наиболее раненому союзнику в радиусе 40 м. Эффект срабатывает не чаще, чем раз в 4 сек."
            },
            { 
                name = "Волчье неистовство", 
                role = "PVE", 
                spellID = 375118,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_bestialfury.blp",
                description = "Мгновенное действие | Восстановление: 1.5 мин.\nПри активации вы и ваши питомцы получаете эффект, который действует 18 сек. Раз в 2 сек. этот эффект усиливает исходящий урон и исцеление на 2%, а также снижает получаемый урон на 1%. Эффект суммируется до 6 раз, но его время действия не обновляется при суммировании.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Зов стаи", 
                role = "PVP", 
                spellID = 375022,
                icon = "Interface\\Icons\\ability_druid_primaltenacity",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации вы сбрасываете 1 эффект обездвиживания и замедления скорости передвижения со всех членов группы в радиусе 40 м. и увеличиваете их скорость передвижения на 25% на 5 сек.\n\nЭтот эффект не может сработать на тех же целях чаще, чем раз в 30 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Вурдалака"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\ghoul-1.blp",
        abilities = {
            { 
                name = "Пожирание слабых", 
                role = "ДД", 
                spellID = 374800,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_howlofterror_red.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона противнику, чей запас здоровья ниже 75%, ваш урон и урон ваших питомцев повышается на 3%. После активации этот эффект действует 5 сек."
            },
            { 
                name = "Близость к смерти", 
                role = "Танк", 
                spellID = 374802,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_darkhand_shadow.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nКогда ваш запас здоровья опускается ниже 75%, вы и ваши питомцы получаете на 3% меньше всего входящего урона. Этот эффект длится 5 сек после активации."
            },
            { 
                name = "Лечение чумой", 
                role = "Хил", 
                spellID = 374804,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_enslavespell_shadow.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПериодическое исцеление от вас и ваших питомцев теперь также восстанавливает 3% от своего эффекта наиболее раненому союзнику, находящемуся в радиусе 40 м."
            },
            { 
                name = "Гнильное поветрие", 
                role = "PVE", 
                spellID = 375053,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_warlock47_border.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы снижаете весь получаемый урон на 6% на 10 сек. В течение этого времени 14% всего наносимого вами урона и исцеления аккумулируется.\n\nПо завершении действия эффект превращается в равномерно распределенный урон по всем противникам в радиусе 40 м от заклинателя, либо в последовательное исцеление союзников в том же радиусе, с приоритетом для наиболее раненых целей.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Могильный зов", 
                role = "PVP", 
                spellID = 374992,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_gravecall.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации с вас и всех ваших питомцев снимаются эффекты подчинения, сна, ошеломления, паралича, страха и ужаса. Вы и ваши питомцы становитесь невосприимчивы к этим эффектам на 1.5 сек.\n\nСпособность имеет общее время перезарядки с другими подобными эффектами, равное 60 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Гармонии"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\harmony-1.blp",
        abilities = {
            { 
                name = "Истинная гармония", 
                role = "ДД", 
                spellID = 374921,
                icon = "Interface\\Icons\\spell_nature_regeneration_02",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПока вы стоите неподвижно в бою, наносимый вами и вашими питомцами урон увеличивается на 1% каждые 1 сек., вплоть до максимального значения в 3%. Этот эффект сохраняется в течение 6 сек. после начала движения."
            },
            { 
                name = "Укрепляющий отвар", 
                role = "Танк", 
                spellID = 374923,
                icon = "Interface\\Icons\\spell_monk_nimblebrew",
                description = "Мгновенное действие | Восстановление: 30 сек.\nБудучи в бою, каждые 10 сек. активируется \"Укрепляющий отвар\", который снижает урон от следующей автоматической атаки, попавшей в вас или ваших питомцев, на 33%. Это снижение урона не может превышать 5% от вашего запаса здоровья. В PVP эффект срабатывает в 2 раза реже."
            },
            { 
                name = "Гармония и духовенство", 
                role = "Хил", 
                spellID = 374925,
                icon = "Interface\\Icons\\spell_monk_zenpilgrimage",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаши прямые исцеляющие заклинания, а также прямые исцеляющие заклинания ваших питомцев, теперь восполняют 2% от произведенного исцеления наиболее раненому союзнику, находящемуся в радиусе 40 м."
            },
            { 
                name = "Циркуляция энергии", 
                role = "PVE", 
                spellID = 375135,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_skill228_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 1 мин.\nПри активации вы жертвуете 10% от своего максимального запаса здоровья, нанося урон от магии природы в размере пожертвованного здоровья 4 противникам в радиусе 8 м. от выбранной цели. За каждого пораженного противника вы восполняете 3% здоровья, или 12%, если поражена только одна цель.\n\nКроме того, в течение следующих 10 сек. получаемый вами и вашими питомцами урон будет снижен на 6%, а наносимый урон (включая критический) и создаваемое исцеление (включая критическое) будут повышены на 6%.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Поиск баланса", 
                role = "PVP", 
                spellID = 375035,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_yinyang_border.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации вы и ваши питомцы получаете на 12 сек. эффект, изначально снижающий весь получаемый урон на 10%.\n\nКаждые 1 сек. это снижение урона будет ослабевать на 1%, но вместо этого наносимый вами и вашими питомцами урон, а также исходящее исцеление, будет увеличиваться на 1%.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Дракона"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\dragon-1.blp",
        abilities = {
            { 
                name = "Ярость дракона", 
                role = "ДД", 
                spellID = 374938,
                icon = "Interface\\Icons\\spell_warrior_dragoncharge",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона противнику, чей запас здоровья выше 25%, ваш урон и урон ваших питомцев повышается на 3%. После активации этот эффект действует 5 сек."
            },
            { 
                name = "Драконье наследие", 
                role = "Танк", 
                spellID = 374940,
                icon = "Interface\\Icons\\ability_warrior_dragonroar",
                description = "Мгновенное действие | Восстановление: 30 сек.\nРаз в 30 сек. вы призываете 3 магические сферы. Каждая подобранная сфера уменьшает входящий урон по вам и вашим питомцам на 1%. Сферы исчезают через 8 сек., а эффект снижения урона действует 40 сек."
            },
            { 
                name = "Круговорот энергии", 
                role = "Хил", 
                spellID = 374946,
                icon = "Interface\\Icons\\spell_fire_playingwithfire",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри вступлении в бой все создаваемое вами и вашими питомцами исцеление повышается на 3% на 15 сек. После этого эффект будет срабатывать каждые 20 сек."
            },
            { 
                name = "Пламя дракона", 
                role = "PVE", 
                spellID = 375141,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_normal01firearrow_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 20 сек.\nПри активации вы запускаете в цель огненный шар, который наносит огненный урон в размере 18.375% (СА*18.375/100 ед.) от силы атаки или 42.75% (СЗ*42.75/100 ед.) от силы заклинаний (в зависимости от того, какой параметр выше). Либо же он восполняет союзнику здоровье в размере 23% (СА*23/100 ед.) от силы атаки или 39.85% (СЗ*39.85/100 ед.) от силы заклинаний (в зависимости от того, какой параметр выше).\n\nЗатем дополнительно наносится 50% от общего нанесенного урона или объема исцеления соответственно в течение 10 сек. Тип критического эффекта и его множитель зависят от класса и специализации.\n\nПри каждом использовании объем наносимого урона или эффективность исцеления увеличивается на 100%. Этот бонус сбрасывается после каждого 3-го применения.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Полет дракона", 
                role = "PVP", 
                spellID = 375040,
                icon = "Interface\\AddOns\\Constellations\\Textures\\inv_ascend_rpgloot_310.blp",
                description = "Радиус действия: 20 м | Применение: 1 сек. | Восстановление: 2 мин.\nПри активации вы перемещаетесь в указанную точку. В течение 5 сек получаемый вами урон будет снижен на 10%.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Изобретателя"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\inventor-1.blp",
        abilities = {
            { 
                name = "Пытливый ум", 
                role = "ДД", 
                spellID = 374875,
                icon = "Interface\\AddOns\\Constellations\\Textures\\spell_arcane_mindmastery.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы наносите 1% больше урона и 1% больше критического урона.\n\nВдобавок, ваша сила атаки или сила заклинаний (выбирается наибольший показатель) повышается на 1%. Ваши питомцы также получают этот бонус, но с 60% эффективности."
            },
            { 
                name = "Высокие технологии", 
                role = "Танк", 
                spellID = 374878,
                icon = "Interface\\AddOns\\Constellations\\Textures\\toolbox.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы получаете на 1% меньше урона. Дополнительно, вы получаете на 1% меньше урона за каждого противника в радиусе 15 м., вплоть до 2 противников."
            },
            { 
                name = "Техно-лекарь", 
                role = "Хил", 
                spellID = 374881,
                icon = "Interface\\AddOns\\Constellations\\Textures\\repair_beam.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nИсцеляющая сила ваших заклинаний повышается на 3%. Этот эффект также распространяется на ваших питомцев, но с 60% эффективности."
            },
            { 
                name = "Криво-пружинный механизм", 
                role = "PVE", 
                spellID = 375100,
                icon = "Interface\\AddOns\\Constellations\\Textures\\update06_border.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы уменьшаете получаемый урон на 6%, а наносимый вами и вашими питомцами урон и создаваемое исцеление увеличиваются на 10% на 10 сек.\n\nПомимо этого, время произнесения следующих 2 заклинаний или способностей уменьшается на 100%. Этот эффект срабатывает только в том случае, если способность или заклинание имеет время произнесения.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Сверхтехнологичные ботинки", 
                role = "PVP", 
                spellID = 375019,
                icon = "Interface\\AddOns\\Constellations\\Textures\\ingenieurboots.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации с вас и ваших питомцев сбрасываются все эффекты обездвиживания и замедления скорости передвижения. В течение следующих 8 сек. все подобные эффекты, наложенные на вас и ваших питомцев, будут длиться на 50% меньше времени.\n\nМожно использовать только на аренас, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Кузнеца"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\blacksmith-1.blp",
        abilities = {
            { 
                name = "Мастерство кузнеца", 
                role = "ДД", 
                spellID = 374864,
                icon = "Interface\\Icons\\spell_paladin_hammerofwrath",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона ваша сила атаки или атакующая сила заклинаний (выбирается наибольший показатель) повышается на 6% на 10 сек. Этот эффект может срабатывать не чаще, чем раз в 20 сек. Ваши питомцы также получают этот бонус, но с 60% эффективности."
            },
            { 
                name = "Железо внутри", 
                role = "Танк", 
                spellID = 374867,
                icon = "Interface\\Icons\\inv_misc_armorkit_09",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы получаете на 3% меньше магического урона."
            },
            { 
                name = "Жар кузни", 
                role = "Хил", 
                spellID = 374868,
                icon = "Interface\\AddOns\\Constellations\\Textures\\inv_flickering_flame",
                description = "Пассивная способность.\nЗатраты маны на произнесение заклинаний для вас и ваших питомцев снижаются на 6%. В PvP этот эффект на 50% менее эффективен."
            },
            { 
                name = "Забытое искусство кузнеца", 
                role = "PVE", 
                spellID = 375088,
                icon = "Interface\\AddOns\\Constellations\\Textures\\inv_blacksmithing_khazgoriananvil",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации, на 10 сек вы получаете эффект, который за каждые 25 ед. затраченной энергии, ярости, силы рун или 15% базовой маны выбрасывает каменные снаряды в 2 противников в радиусе 8 м от вашей текущей цели. Эти снаряды замедлят противников на 75% на 3 сек.\n\nЗа каждого пораженного противника вы восполняете 6 ед. энергии, ярости, силы рун или 2% базового запаса маны. Каждый эффект восполнения ресурса понижает получаемый вами и вашими питомцами урон на 1%, повышает наносимый вами и вашими питомцами урон и исходящее исцеление на 3%. Этот эффект суммируется до 3 раз и действует 8 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Металлический панцирь", 
                role = "PVP", 
                spellID = 375016,
                icon = "Interface\\AddOns\\Constellations\\Textures\\5_paladinskill44_border",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации с вас и ваших питомцев рассеиваются все наложенные болезни, а также снимаются все эффекты кровотечения и яда. Кроме того, вы и ваши питомцы получаете на 10% меньше физического урона в течение 6 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Лисы"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\fox-1.blp",
        abilities = {
            { 
                name = "Лисье проворство", 
                role = "ДД", 
                spellID = 374927,
                icon = "Interface\\Icons\\inv_foxwyvernpetred",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона противнику, чей запас здоровья выше 25%, ваш критический урон и критический урон ваших питомцев повышается на 4%. После активации этот эффект действует 5 сек."
            },
            { 
                name = "Мистическая шкура", 
                role = "Танк", 
                spellID = 374929,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_foxskinmystic.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри получении стихийного урона вы и ваши питомцы в течение 15 сек. будете получать на 4% меньше урона от той же стихии. Этот эффект имеет время восстановления 10 сек."
            },
            { 
                name = "Лихой умысел", 
                role = "Хил", 
                spellID = 374936,
                icon = "Interface\\Icons\\inv_herbalism_70_foxflower",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПока вы стоите неподвижно в бою, создаваемое вами и вашими питомцами исцеление повышается на 1% каждые 1 сек., вплоть до максимального значения в 3%. Этот эффект сохраняется в течение 6 сек. после начала движения."
            },
            { 
                name = "Локальная буря", 
                role = "PVE", 
                spellID = 375139,
                icon = "Interface\\Icons\\spell_sandstorm",
                description = "Радиус действия: 40 м | Мгновенное действие\nПри активации вы создаете локальную песчаную бурю в указанной области на 20 сек., радиус действия которой составляет 8 м.\n\nНаходясь в песчаной буре, урон и создаваемое исцеление для вас и ваших питомцев повышаются на 6%. Помимо этого, вы и ваши питомцы мгновенно восполняете 2% здоровья и дополнительно раз в 2 сек.\n\nПовторное использование данной способности перемещает бурю в выбранную область. Время восстановления начинается только после окончания действия эффекта.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Зыбучие пески", 
                role = "PVP", 
                spellID = 375038,
                icon = "Interface\\Icons\\spell_quicksand",
                description = "Радиус действия: 20 м | Мгновенное действие | Восстановление: 2 мин.\nПри активации противника окутывают зыбучие пески, снижая скорость его перемещения на 100%. Каждые 0.5 сек. к противнику возвращается 5% от его обычной скорости передвижения.\n\nВремя действия эффекта — 5 сек. Если эффект заканчивается преждевременно, то противник на 2 сек сбивается с ног.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
	["Скитальца"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\wanderer-1.blp",
        abilities = {
            { 
                name = "Находчивость скитальца", 
                role = "ДД", 
                spellID = 374883,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_62_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона ваш критический урон и критический урон ваших питомцев повышается на 6% на 10 сек. Этот эффект срабатывает не чаще, чем раз в 20 сек."
            },
            { 
                name = "Твердая решимость", 
                role = "Танк", 
                spellID = 374885,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_64_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПока вы стоите неподвижно в бою, получаемый вами и вашими питомцами урон снижается на 1% каждые 1 сек., вплоть до максимального значения в 3%. Этот эффект сохраняется в течение 6 сек. после начала движения."
            },
            { 
                name = "Избранный путь", 
                role = "Хил", 
                spellID = 374887,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_63_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nСоздаваемое вами и вашими питомцами исцеление увеличивается на величину, которая меняется каждые 5 сек. в бою. Этот бонус последовательно меняется в следующем порядке: 3% / 2% / 1%."
            },
            { 
                name = "Оберег скитальца", 
                role = "PVE", 
                spellID = 375111,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_holy_amulet_border.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы мгновенно нейтрализуете все негативные магические эффекты, проклятия, болезни и яды на себе. Кроме того, вы и ваши питомцы восполняете 10% здоровья за 10 сек.\n\nПока эффект восполнения здоровья активен, ваша скорость атак и произнесения заклинаний повышается на 12%, а 20% получаемого вами эффективного исцеления дополнительно преобразуется в эффект поглощения урона.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Дар скитальца", 
                role = "PVP", 
                spellID = 375020,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_paladinskill18_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 2 мин.\nПри активации цель восстанавливает 4% максимального запаса здоровья каждые 2 сек. в течение 10 сек.\n\nЕсли в момент использования запас здоровья цели был ниже 33%, то получаемый ею урон будет дополнительно снижен на 5% на время действия эффекта.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Льва"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\lion-1.blp",
        abilities = {
            { 
                name = "Львиная доминация", 
                role = "ДД", 
                spellID = 374859,
                icon = "Interface\\Icons\\ability_hunter_goforthethroat",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри вступлении в бой ваш критический урон и критический урон ваших питомцев повышается на 4% на 15 сек. После этого эффект будет срабатывать каждые 20 сек."
            },
            { 
                name = "Львиная шкура", 
                role = "Танк", 
                spellID = 374861,
                icon = "Interface\\Icons\\inv_skinning_80_coarsefur",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь магический урон, получаемый вами и вашими питомцами, снижается на 6%, но не более чем на 15% от вашей выносливости."
            },
            { 
                name = "Звериная благодать", 
                role = "Хил", 
                spellID = 374862,
                icon = "Interface\\Icons\\spell_holy_blessingofagility",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВо время произнесения заклинаний ваша мана восполняется со скоростью, равной 24% от обычной. В PvP этот эффект на 50% менее эффективен."
            },
            { 
                name = "Стремительность Льва", 
                role = "PVE", 
                spellID = 375086,
                icon = "Interface\\Icons\\achievement_legionpvp3tier4",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы и ваши питомцы обретаете крупицу львиной мощи на 15 сек, что повышает скорость атаки и произнесения заклинаний на 18%.\n\nВо время действия этого эффект вы и ваши питомцы получаете на 8% меньше урона, а продолжительность эффектов обездвиживания и снижения скорости передвижения будет сокращена на 50%.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Неукротимость", 
                role = "PVP", 
                spellID = 375015,
                icon = "Interface\\Icons\\ability_druid_kingofthejungle",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации с вас и ваших питомцев снимаются все эффекты оглушения.\n\nЭта способность имеет общее время восстановления 60 сек. с другими подобными эффектами.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Торговца"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\vendor-1.blp",
        abilities = {
            { 
                name = "Смекалка торговца", 
                role = "ДД", 
                spellID = 374815,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_forsaken_caster.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаша сила атаки или сила заклинаний (выбирается наибольший показатель) повышается. Это увеличение меняется каждые 5 сек. в следующей последовательности: 2% / 3% / 4%. Ваши питомцы получают такой же эффект, но с 60% эффективности."
            },
            { 
                name = "Бартер", 
                role = "Танк", 
                spellID = 374822,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_wetbag_water.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВ течение 5 сек. вы и ваши питомцы получаете на 3% меньше физического урона. Спустя 5 сек. эффект меняется, и вы начинаете получать на 3% меньше магического урона. Затем цикл повторяется."
            },
            { 
                name = "Гарантированные скидки", 
                role = "Хил", 
                spellID = 374825,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_note_01_yellow.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nИспользование заклинания или способности восполняет 6% от их базовой стоимости вам и вашим питомцам. В PvP этот эффект на 50% менее эффективен."
            },
            { 
                name = "Генератор искривления", 
                role = "PVE", 
                spellID = 375064,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_tower_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 45 сек.\nПри активации устанавливает в выбранной зоне генератор на 10 сек. Пока он активен, союзники в его радиусе получают на 9% больше исцеления от вас и ваших питомцев. В то же время, противники в зоне действия генератора получают на 9% больше урона от вас и ваших питомцев, их скорость передвижения снижается на 25%, а наносимый ими урон по вам и вашим питомцам уменьшается на 4%.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Преобразователь", 
                role = "PVP", 
                spellID = 374997,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_blue_bag_01.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации вас окутывают нестабильные временные нити на 5 сек. Пока нити активны, вы и ваши питомцы получаете на 5% меньше урона. Когда действие эффекта завершается, 25% полученного вами урона преобразуется в здоровье. Этот эффект можно рассеять.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Феникса"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\phoenix-1.blp",
        abilities = {
            { 
                name = "Наследие феникса", 
                role = "ДД", 
                spellID = 374832,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_phoenix_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nНаходясь в бою, каждые 30 сек. вы призываете 3 магические сферы. Каждая подобранная сфера повышает ваш урон и урон ваших питомцев на 1%. Сферы исчезают через 8 сек, а эффект усиления урона действует 40 сек."
            },
            { 
                name = "Обуглившаяся плоть", 
                role = "Танк", 
                spellID = 374838,
                icon = "Interface\\Icons\\artifactability_firemage_phoenixbolt",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы получаете на 3% меньше физического урона."
            },
            { 
                name = "Слезы феникса", 
                role = "Хил", 
                spellID = 374839,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_t_phoenix_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\n2% всего эффективного исцеления, исходящего от вас и ваших питомцев, теперь преобразуется в эффект поглощения урона для цели. Эффект суммируется, но не может превышать 2% максимального здоровья цели."
            },
            { 
                name = "Древняя сфера", 
                role = "PVE", 
                spellID = 375071,
                icon = "Interface\\AddOns\\Constellations\\Textures\\skill_icon_skill86_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 1 мин.\nПри активации вы выпускаете в указанную цель магическую сферу. При соприкосновении с целью, она взрывается в радиусе 10 м, на 10 сек активируя дополнительные эффекты:\n\nПротивники: наносят на 6% меньше урона вам и вашим питомцам, получают на 12% больше урона от вас и ваших питомцев, и их скорость передвижения снижается на 20%.\n\nСоюзники: получают на 12% больше исцеления от вас и ваших питомцев, а их скорость передвижения повышается на 15%.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Искажение пространства", 
                role = "PVE", 
                spellID = 375074,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_teleport_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри активации перемещает к вам пораженных сферой противников в радиусе 40 м.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Пламя феникса", 
                role = "PVP", 
                spellID = 375001,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_phoenixflames.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации вы вызываете немоту у 5 противников в радиусе 8 м. на 2 сек. Одновременно с этим вам и вашим питомцам восстанавливается 2% максимального запаса маны или 15 ед. энергии, ярости, тонуса или силы рун каждые 2 сек. в течение 6 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Часового"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\sentinel-1.blp",
        abilities = {
            { 
                name = "Искусность стража", 
                role = "ДД", 
                spellID = 374870,
                icon = "Interface\\Icons\\inv_pet_wardenowl",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаш критический урон и критический урон ваших питомцев повышается на 1%. Дополнительно, каждые 5 сек., этот бонус будет меняться в следующей последовательности: 3% / 2% / 1%."
            },
            { 
                name = "Маневренность", 
                role = "Танк", 
                spellID = 374872,
                icon = "Interface\\Icons\\rogue_burstofspeed",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь получаемый вами и вашими питомцами урон от заклинаний, действующих по области, снижается на 9%."
            },
            { 
                name = "Дар луны", 
                role = "Хил", 
                spellID = 374873,
                icon = "Interface\\AddOns\\Constellations\\Textures\\moon_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nИсцеляющая сила ваших заклинаний повышается. Это увеличение меняется каждые 5 сек. в следующей последовательности: 4% / 3% / 2%. Ваши питомцы получают такой же эффект, но с 60% эффективности."
            },
            { 
                name = "Сад Элуны", 
                role = "PVE", 
                spellID = 375096,
                icon = "Interface\\AddOns\\Constellations\\Textures\\naturecocktail_border.blp",
                description = "Мгновенное действие | Восстановление: 1.5 мин.\nПри активации вы высвобождаете силу природы, создавая поле цветов радиусом до 40 м. перед заклинателем на 5 сек. Все противники в данной зоне будут передвигаться и атаковать на 20% медленнее, а союзники будут иметь повышенную на 20% скорость передвижения. Помимо этого, вы и ваши питомцы получите эффект снижения получаемого урона на 6%, повышения наносимого урона и исходящего исцеления на 12%. Время действия 15 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Объятия Элуны", 
                role = "PVP", 
                spellID = 375018,
                icon = "Interface\\AddOns\\Constellations\\Textures\\talentspec_druid_balance.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации вы и ваши питомцы сливаетесь с тенями, значительно снижая вероятность того, что противник вас заметит. Эффект действует до 30 сек, или пока вы не совершите какое-либо действие.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Вуду"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\voodoo-1.blp",
        abilities = {
            { 
                name = "Колдовство вуду", 
                role = "ДД", 
                spellID = 374811,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_soulfire_purple.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри нанесении урона противнику, ваш урон и урон ваших питомцев повышается на 3% на 5 сек."
            },
            { 
                name = "Усиление Моджо", 
                role = "Танк", 
                spellID = 374812,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_liquidstone_shadow.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь получаемый вами и вашими питомцами урон снижается на 2%."
            },
            { 
                name = "Магия вуду", 
                role = "Хил", 
                spellID = 374813,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_curse_purple.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nКаждые 5 сек. вы и ваши питомцы восстанавливаете ману в размере 4% от вашего показателя духа. В PvP максимальный объем восстановленной маны не может превышать 75 ед."
            },
            { 
                name = "Тотем вуду", 
                role = "PVE", 
                spellID = 375059,
                icon = "Interface\\Icons\\ability_racial_wardoftheloashadow",
                description = "Радиус действия: 40 м | Мгновенное действие\nПри активации вы и ваши питомцы снижаете весь получаемый урон на 3%. Вы также устанавливаете в указанной области неуязвимый змеиный идол на 20 сек.\n\nИдол повышает весь получаемый противниками урон от вас и ваших питомцев в радиусе 8 м на 6%, а также замедляет их скорость передвижения на 20%. Союзники в радиусе идола получают на 6% больше исцеления от заклинателя.\n\nПовторное использование этой способности перемещает идол в выбранную область. Время восстановления эффект аначинается только после окончания действия идола.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Гнев Лоа", 
                role = "PVP", 
                spellID = 374996,
                icon = "Interface\\AddOns\\Constellations\\Textures\\5_voodoo_border.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации ваша скорость атаки ближнего и дальнего боя, а также скорость произнесения заклинаний у вас и ваших питомцев увеличивается на 10%. За каждые 3% недостающего здоровья этот эффект усиливается на 1%, вплоть до 10%.\n\nПока эффект активен, применение заклинаний не будет задерживаться при получении урона. Эффект длится 12 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Змея"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\serpent-1.blp",
        abilities = {
            { 
                name = "Изменчивость змеи", 
                role = "ДД", 
                spellID = 374827,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_snakevariability.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаш урон и урон ваших питомцев увеличивается. Это усиление меняется каждые 5 сек. в следующей последовательности: 3% / 2% / 1%."
            },
            { 
                name = "Адаптация рептилии", 
                role = "Танк", 
                spellID = 374829,
                icon = "Interface\\Icons\\achievement_dungeon_aspixandadderis",
                description = "Мгновенное действие | Восстановление: 30 сек.\n2% всего урона, который получаете вы и ваши питомцы, преобразуется в эффект поглощения урона. Этот эффект может суммироваться, но его общая величина не может превышать 5% от вашего максимального здоровья. Эффект действует 10 сек."
            },
            { 
                name = "Плетение жизни", 
                role = "Хил", 
                spellID = 374831,
                icon = "Interface\\Icons\\ability_monk_dragonkick",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает эффективность всего периодического исцеления, исходящего от вас и ваших питомцев, на 3%."
            },
            { 
                name = "Частица Назжатара", 
                role = "PVE", 
                spellID = 375067,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_paladinskill39_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 1 мин.\nПри активации вы создаете водоворот глубин радиусом 8 м. Противники, находящиеся в его пределах, получают на 6% больше урона от вас и ваших питомцев. Исцеление, накладываемое вами и вашими питомцами на союзников в радиусе водоворота, усиливается на 6%, а получаемый вами и вашими питомцами урон уменьшается на 3%. Пока вы находитесь в водовороте, вы получаете возможность использовать способность \"Рывок из глубин\". Время действия — 20 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Рывок из глубин", 
                role = "PVE", 
                spellID = 375070,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_shamanskill17_border.blp",
                description = "Радиус действия: 20 м | Мгновенное действие | Восстановление: 8 сек.\nПозволяет переместиться в указанную область. Перемещает текущий активный водоворот в выбранную область. Способность можно произнести во время чтения других заклинаний. Можно использовать только находясь в зоне \"Частица Назжатара\".\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Особенность рептилии", 
                role = "PVP", 
                spellID = 374999,
                icon = "Interface\\AddOns\\Constellations\\Textures\\custom_fish_speed_border.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации в течение 5 сек. 25% всего урона, получаемого вами и вашими питомцами, будет преобразовано в эффект периодического урона. Этот урон будет равномерно распределен на 3 такта, с нанесением урона раз в 2 сек. Пока эффект активен, вы и ваши питомцы получаете на 5% больше исцеления.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            }
        }
    },
    ["Безликого"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\faceless-1.blp",
        abilities = {
            { 
                name = "Шепот бездны", 
                role = "ДД", 
                spellID = 374902,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_voidwhisper_.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nБудучи в бою, ваш критический урон и критический урон ваших питомцев повышается на 2%.\n\nДополнительно, вы наносите на 1% больше критического урона за каждого противника в радиусе 35 м., с учетом максимум 2 противников."
            },
            { 
                name = "Пустота", 
                role = "Танк", 
                spellID = 374905,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_voidorb.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри получении урона вы и ваши питомцы наносите 2% от полученного урона обратно противнику. Однако этот ответный урон не может превышать 2% от вашего максимального запаса здоровья."
            },
            { 
                name = "Темная благодать", 
                role = "Хил", 
                spellID = 374907,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_voidgrace.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы восполняете на 3% больше здоровья целям, запас здоровья которых выше 25%."
            },
            { 
                name = "Поклонение Бездне", 
                role = "PVE", 
                spellID = 375123,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_assassinskill11_border.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПозволяет применить \"Дар Темных богов\" 3 раза. Время действия 45 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Дар Темных богов", 
                role = "PVE", 
                spellID = 375124,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_creatingshadow_border.blp",
                description = "Мгновенное действие | Восстановление: 1.5 сек.\nПри активации уменьшает время восстановления следующего примененного заклинания или способности для вас и ваших питомцев на 50%, но не более 7 сек.\n\nЭффект срабатывает только в том случае, если способность или заклинание имеет время восстановления.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Теневой маяк", 
                role = "PVP", 
                spellID = 375026,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_shadowhole.blp",
                description = "Радиус действия: 20 м | Мгновенное действие | Восстановление: 2 мин.\nПри активации вы создаёте теневой маяк в выбранном месте. Спустя 2 сек. вы автоматически переноситесь к этому маяку и замедляете до 5 противников в радиусе 8 м. на 50% на 3 сек.\n\nСпособность можно произнести во время чтения других заклинаний. Перемещение не сработает, если вы находитесь под эффектом обездвиживания или потери контроля.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            },
            { 
                name = "Союзная сила", 
                role = "Союзная", 
                spellID = 375896,
                icon = "Interface\\Icons\\spell_nature_strength",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу атаки на PL*1 ед."
            },
            { 
                name = "Союзная мощь", 
                role = "Союзная", 
                spellID = 375897,
                icon = "Interface\\Icons\\ability_evoker_essenceburst2",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу заклинаний на PL*0.575 ед."
            },
            { 
                name = "Союзная стойкость", 
                role = "Союзная", 
                spellID = 375898,
                icon = "Interface\\Icons\\ability_toughness",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает выносливость на PL*0.75 ед."
            },
            { 
                name = "Созвездие Безликого", 
                role = "Союзная", 
                spellID = 375895,
                icon = "Interface\\AddOns\\Constellations\\Textures\\voidelf_faceless.blp",
                description = "Союзная способность\nМгновенное действие\nПозволяет активировать дополнительный пассивный навык, дарованный созвездием."
            }
        }
    },
    ["Вулкана"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\volcano-1.blp",
        abilities = {
            { 
                name = "Вулканический гнев", 
                role = "ДД", 
                spellID = 374908,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_volcanorage.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаша сила атаки или атакующая сила заклинаний (выбирается наибольший показатель) повышается на 3%. Этот эффект также распространяется на ваших питомцев, но с 60% эффективности."
            },
            { 
                name = "Магматические пластины", 
                role = "Танк", 
                spellID = 374911,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_magmaticplates.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nБудучи в бою, каждые 10 сек, активируется \"Магматическая пластина\", которая снижает урон от следующего прямого заклинания, попавшего в вас или ваших питомцев, на 33%. Это снижение урона не может превышать 5% от вашего запаса здоровья. В PVP эффект срабатывает в 2 раза реже."
            },
            { 
                name = "Прижигание ран", 
                role = "Хил", 
                spellID = 374913,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_cauterizingwounds.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаши исцеляющие заклинания и исцеляющие заклинания ваших питомцев восполняют 2% дополнительного здоровья."
            },
            { 
                name = "Извержение вулкана", 
                role = "PVE", 
                spellID = 375125,
                icon = "Interface\\Icons\\spell_fire_volcano",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 1 мин.\nПри активации вы снижаете весь получаемый вами урон на 6% и выпускаете волну магмы, поражающую всех противников в радиусе 8 м. от выбранной цели и союзников в радиусе 20 м. от цели.\n\nПульсирующая магма на 10 сек. остаётся на противниках, увеличивая получаемый ими урон от заклинателя и его питомцев на 12%. Кроме того, 5 случайных противников раз в 5 сек. будут сбиваться с ног на 2 сек.\n\nПрижигающая магма остаётся на союзника в течение 10 сек., увеличивая получаемое ими исцеление от заклинателя и его питомцев на 12%.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Извержение", 
                role = "PVP", 
                spellID = 375029,
                icon = "Interface\\Icons\\ability_rhyolith_magmaflow_whole",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации с вас и ваших питомцев рассеиваются все наложенные болезни, а также снимаются все эффекты кровотечения и яда.\n\nКроме того, ваша сила атаки или сила заклинаний (выбирается наибольший показатель) повышается на 8% на 6 сек. Это повышение силы атаки или силы заклинаний дублируется для ваших питомцев, но с 60% эффективности.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            },
            { 
                name = "Союзная сила", 
                role = "Союзная", 
                spellID = 375900,
                icon = "Interface\\Icons\\spell_nature_strength",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу атаки на PL*1 ед."
            },
            { 
                name = "Союзная мощь", 
                role = "Союзная", 
                spellID = 375901,
                icon = "Interface\\Icons\\ability_evoker_essenceburst2",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу заклинаний на PL*0.575 ед."
            },
            { 
                name = "Союзная стойкость", 
                role = "Союзная", 
                spellID = 375902,
                icon = "Interface\\Icons\\ability_toughness",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает выносливость на PL*0.75 ед."
            },
            { 
                name = "Созвездие Вулкана", 
                role = "Союзная", 
                spellID = 375899,
                icon = "Interface\\AddOns\\Constellations\\Textures\\darkirondwarf_vulkan.blp",
                description = "Союзная способность\nМгновенное действие\nПозволяет активировать дополнительный пассивный навык, дарованный созвездием."
            }
        }
    },
    ["Демона"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\demon-1.blp",
        abilities = {
            { 
                name = "Течение Скверны", 
                role = "ДД", 
                spellID = 374847,
                icon = "Interface\\Icons\\inv_felbarrage",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри вступлении в бой ваша сила атаки или сила заклинаний (выбирается наибольший показатель) повышается на 4% на 15 сек. После этого эффект будет срабатывать каждые 20 секунд. Ваши питомцы также получают этот бонус, но с 60% эффективности."
            },
            { 
                name = "Огрубевшая кожа", 
                role = "Танк", 
                spellID = 374851,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_auracloak_felfire.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВесь периодический урон, получаемый вами и вашими питомцами, снижается на 5%."
            },
            { 
                name = "Демонические знания", 
                role = "Хил", 
                spellID = 374852,
                icon = "Interface\\Icons\\inv_misc_fel_tainted_cache",
                description = "Мгновенное действие | Восстановление: 30 сек.\nБудучи в бою, каждые 5 сек. вы и ваши питомцы восполняете ману в размере 8% от вашего показателя восполнения маны. В PvP максимальное восполнение ограничено 75 ед."
            },
            { 
                name = "Демоническая печать", 
                role = "PVE", 
                spellID = 375079,
                icon = "Interface\\AddOns\\Constellations\\Textures\\uico_unholy_spell_10_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 1 мин.\nПри активации вы размещаете в выбранной области демоническую печать, которая взрывается, сбивая до 5 противников в радиусе 8 м. с ног на 2.5 сек.\n\nЗа каждого пораженного противника (максимум 3) вы и ваши питомцы увеличиваете весь наносимый урон на 2%, создаваемое исцеление на 2%, и снижаете получаемый урон на 1%. Время действия — 20 сек.\n\nЕсли взрыв печати поразит только одну цель, вы и ваши питомцы получите сразу 3 заряда эффекта.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Демоническое сокрушение", 
                role = "PVP", 
                spellID = 375010,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_warlock_personaltp.blp",
                description = "Применение: 0.5 сек. | Восстановление: 2 мин.\nПри активации вы подбрасываете в воздух до 5 противников в радиусе 8 м., оглушая их на 2 сек. За каждого пораженного противника вы и ваши питомцы получаете на 2% меньше урона в течение 4 сек., с максимальным снижением урона до 10%.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            },
            { 
                name = "Союзная сила", 
                role = "Союзная", 
                spellID = 375888,
                icon = "Interface\\Icons\\spell_nature_strength",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу атаки на PL*1 ед."
            },
            { 
                name = "Союзная мощь", 
                role = "Союзная", 
                spellID = 375889,
                icon = "Interface\\Icons\\ability_evoker_essenceburst2",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу заклинаний на PL*0.575 ед."
            },
            { 
                name = "Союзная стойкость", 
                role = "Союзная", 
                spellID = 375890,
                icon = "Interface\\Icons\\ability_toughness",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает выносливость на PL*0.75 ед."
            },
            { 
                name = "Созвездие Демона", 
                role = "Союзная", 
                spellID = 375887,
                icon = "Interface\\AddOns\\Constellations\\Textures\\eredar_demon.blp",
                description = "Союзная способность\nМгновенное действие\nПозволяет активировать дополнительный пассивный навык, дарованный созвездием."
            }
        }
    },
    ["Магистра"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\magister-1.blp",
        abilities = {
            { 
                name = "Необузданная магия", 
                role = "ДД", 
                spellID = 374841,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_arcanetwist_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаш урон и урон ваших питомцев увеличивается. Это усиление меняется каждые 5 сек. в следующей последовательности: 3% / 2% / 1%."
            },
            { 
                name = "Защитные чары", 
                role = "Танк", 
                spellID = 374844,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_arcaneshield_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\n6% всего урона, получаемого вами и вашими питомцами, теперь будет отложено и нанесено постепенно в течение 4 сек. Этот отложенный урон не создает угрозы, не прерывает эффекты потери контроля, незаметности или невидимости."
            },
            { 
                name = "Сакральное знание", 
                role = "Хил", 
                spellID = 374846,
                icon = "Interface\\AddOns\\Constellations\\Textures\\nhi_arcane_scroll_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы исцеляете эффективнее:\nНа 2% больше, если запас здоровья цели ниже 90%.\nНа 4% больше, если запас здоровья цели ниже 70%."
            },
            { 
                name = "Чародейская подпитка", 
                role = "PVE", 
                spellID = 375076,
                icon = "Interface\\AddOns\\Constellations\\Textures\\skill_icon_skill145_border.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы начинаете напитываться исходящей из лей-линий чародейской магией. Раз в 0.2 сек. в течение 1 сек, вы и ваши питомцы получаете заряд эффекта, усиливающего наносимый урон на 1%, снижающего получаемый урон на 1%, увеличивающего создаваемое исцеление на 1% и ускоряющего время восстановления ваших классовых заклинаний и способностей на 0.1 сек. раз в 1 сек. в течение 15 сек. за каждый заряд эффекта.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Дикая магия", 
                role = "PVP", 
                spellID = 375006,
                icon = "Interface\\AddOns\\Constellations\\Textures\\skill_icon_skill145_border.blp",
                description = "Радиус действия: 20 м | Мгновенное действие | Восстановление: 2 мин.\nПри активации вы дестабилизируете магические потоки противника на 10 сек. Следующие 3 заклинаний или способностей прямого урона, примененные им, будут исцелять заклинателя на 25% от их исходного урона, а заклинания прямого исцеления нанесут противнику урон в размере 17% от исходного объема исцеления.\n\nЭта способность является магией, и ее можно развеять. Повторное наложение на ту же цель невозможно в течение 30 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            },
            { 
                name = "Союзная сила", 
                role = "Союзная", 
                spellID = 375884,
                icon = "Interface\\Icons\\spell_nature_strength",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу атаки на PL*1 ед."
            },
            { 
                name = "Союзная мощь", 
                role = "Союзная", 
                spellID = 375885,
                icon = "Interface\\Icons\\ability_evoker_essenceburst2",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу заклинаний на PL*0.575 ед."
            },
            { 
                name = "Союзная стойкость", 
                role = "Союзная", 
                spellID = 375886,
                icon = "Interface\\Icons\\ability_toughness",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает выносливость на PL*0.75 ед."
            },
            { 
                name = "Созвездие Магистра", 
                role = "Союзная", 
                spellID = 375883,
                icon = "Interface\\AddOns\\Constellations\\Textures\\orc_barbarian.blp",
                description = "Союзная способность\nМгновенное действие\nПозволяет активировать дополнительный пассивный навык, дарованный созвездием."
            }
        }
    },
    ["Наару"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\naaru-1.blp",
        abilities = {
            { 
                name = "Неизбежная кара", 
                role = "ДД", 
                spellID = 374915,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_inevitablepunishment.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПри вступлении в бой ваш урон и урон ваших питомцев повышается на 3% на 15 сек. После этого эффект будет срабатывать каждые 20 сек."
            },
            { 
                name = "Озаренный Светом", 
                role = "Танк", 
                spellID = 374917,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_illuminatedbylight.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nКаждый раз, когда вы уклоняетесь, блокируете, парируете атаку или противник по вам промахивается, получаемый вами и вашими питомцами урон снижается на 1%. Этот эффект может суммироваться до 3 раз, но при получении урона и автоматически каждые 8 сек. снимается 1 заряд эффекта."
            },
            { 
                name = "Длань Наару", 
                role = "Хил", 
                spellID = 374919,
                icon = "Interface\\Icons\\inv_pet_naaru_yellow",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаши заклинания прямого исцеления и исцеление ваших питомцев теперь восполняют 1% от исцелённого здоровья 3 наиболее раненым союзникам в радиусе 40 м."
            },
            { 
                name = "Копье Света", 
                role = "PVE", 
                spellID = 375130,
                icon = "Interface\\Icons\\inv_polearm_2h_odynspear_d_02",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 1 мин.\nПри активации вы снижаете весь получаемый вами и вашими питомцами урон на 4% на 15 сек. Вы также бросаете копье Света в указанную цель. Оно поражает всех противников в радиусе 8 м. и союзников в радиусе 20 м. от цели.\n\nПораженные противники в течение 15 сек. будут получать на 9% больше урона от вас и ваших питомцев, а 5 из них будут обездвижены на 5 сек.\n\nПопавшие под действие эффекта союзники в течение 15 сек. будут получать на 9% больше исцеления от вас и ваших питомцев, а у 5 из них будет увеличена скорость передвижения на 25% на 5 сек.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Клеймо Смирения", 
                role = "PVP", 
                spellID = 375033,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_priestskill07_border.blp",
                description = "Радиус действия: 40 м | Мгновенное действие | Восстановление: 2 мин.\nПри активации вы снижаете текущий и максимальный запас здоровья цели на 10%. Эффект действует 10 сек.\nПовторное применение этого эффекта от разных источников увеличивает время его действия на 10 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            },
            { 
                name = "Союзная сила", 
                role = "Союзная", 
                spellID = 375904,
                icon = "Interface\\Icons\\spell_nature_strength",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу атаки на PL*1 ед."
            },
            { 
                name = "Союзная мощь", 
                role = "Союзная", 
                spellID = 375905,
                icon = "Interface\\Icons\\ability_evoker_essenceburst2",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу заклинаний на PL*0.575 ед."
            },
            { 
                name = "Союзная стойкость", 
                role = "Союзная", 
                spellID = 375906,
                icon = "Interface\\Icons\\ability_toughness",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает выносливость на PL*0.75 ед."
            },
            { 
                name = "Созвездие Наару", 
                role = "Союзная", 
                spellID = 375903,
                icon = "Interface\\AddOns\\Constellations\\Textures\\lightforged_naaru.blp",
                description = "Союзная способность\nМгновенное действие\nПозволяет активировать дополнительный пассивный навык, дарованный созвездием."
            }
        }
    },
    ["Ящера"] = {
        icon = "Interface\\AddOns\\Constellations\\Textures\\raptor-1.blp",
        abilities = {
            { 
                name = "Боевые когти", 
                role = "ДД", 
                spellID = 374854,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_clawstrike_border.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВаш урон и урон ваших питомцев увеличивается 2%."
            },
            { 
                name = "Регенерация плоти", 
                role = "Танк", 
                spellID = 374856,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_regeneration.blp",
                description = "Мгновенное действие | Восстановление: 30 сек.\n2% от урона, нанесенного вам и вашим питомцам, теперь преобразуется в периодическое исцеление, которое равными долями восполняет здоровье в течение 3 сек. Эффект суммируется."
            },
            { 
                name = "Дар Лоа", 
                role = "Хил", 
                spellID = 374858,
                icon = "Interface\\Icons\\inv_hand_1h_trollshaman_c_01",
                description = "Мгновенное действие | Восстановление: 30 сек.\nВы и ваши питомцы исцеляете эффективнее:\nНа 2% больше, если запас здоровья цели выше 90%.\nНа 4% больше, если запас здоровья цели выше 70%."
            },
            { 
                name = "Позаимствованная сила", 
                role = "PVE", 
                spellID = 375081,
                icon = "Interface\\AddOns\\Constellations\\Textures\\_tikiman2_bloodtroll.blp",
                description = "Мгновенное действие | Восстановление: 1 мин.\nПри активации вы и ваши питомцы принимаете \"Дар Смерти\" на 10 сек. Он повышает вашу скорость перемещения на 25% и снижает получаемый урон на 6%.\n\nВо время действия эффекта весь наносимый вами и вашими питомцами урон повышается на 12% урона, а исцеляющие заклинания восполняют дополнительно 12% здоровья. Магия \"Лоа Смерти\" затмевает ваш обзор и позволяет использовать \"Теневой рывок\".\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Теневой рывок", 
                role = "PVE", 
                spellID = 375083,
                icon = "Interface\\Icons\\spell_nzinsanity_chasedbyshadows",
                description = "Радиус действия: 20 м | Мгновенное действие | Восстановление: 3 сек.\nВы мгновенно перемещаетесь вперед на расстояние до 8 м. Можно использовать только во время действия эффекта \"Позаимствованная сила\". Эту способность нельзя использовать под действием эффектов обездвиживания.\n\nМожно использовать только в подземельях, рейдах и в открытом мире."
            },
            { 
                name = "Звериное неистовство", 
                role = "PVP", 
                spellID = 375013,
                icon = "Interface\\AddOns\\Constellations\\Textures\\5_skill143_border.blp",
                description = "Мгновенное действие | Восстановление: 2 мин.\nПри активации ваша вероятность критического эффекта и вероятность критического эффекта ваших питомцев увеличивается на 15%. За каждые 3% недостающего здоровья этот эффект усиливается на 1%, вплоть до 10%.\n\nПока эффект активен, вероятность уклонения противников для вас и ваших питомцев снижается на 10%. Эффект длится 12 сек.\n\nМожно использовать только на аренах, полях боя и в режиме войны в открытом мире."
            },
            { 
                name = "Союзная сила", 
                role = "Союзная", 
                spellID = 375892,
                icon = "Interface\\Icons\\spell_nature_strength",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу атаки на PL*1 ед."
            },
            { 
                name = "Союзная мощь", 
                role = "Союзная", 
                spellID = 375893,
                icon = "Interface\\Icons\\ability_evoker_essenceburst2",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает силу заклинаний на PL*0.575 ед."
            },
            { 
                name = "Союзная стойкость", 
                role = "Союзная", 
                spellID = 375894,
                icon = "Interface\\Icons\\ability_toughness",
                description = "Мгновенное действие | Восстановление: 30 сек.\nПовышает выносливость на PL*0.75 ед."
            },
            { 
                name = "Созвездие Ящера", 
                role = "Союзная", 
                spellID = 375891,
                icon = "Interface\\AddOns\\Constellations\\Textures\\zandalaritroll_lizard.blp",
                description = "Союзная способность\nМгновенное действие\nПозволяет активировать дополнительный пассивный навык, дарованный созвездием."
            }
        }
    }
} 

local CONSTELLATIONS_LIST = {
    "Созвездие Змея",
    "Созвездие Быка",
    "Созвездие Варвара",
    "Созвездие Волка",
    "Созвездие Вурдалака",
    "Созвездие Вуду",
    "Созвездие Гармонии",
    "Созвездие Дракона",
    "Созвездие Лисы",
    "Созвездие Кузнеца",
    "Созвездие Изобретателя",
	"Созвездие Скитальца",
    "Созвездие Льва",
    "Созвездие Торговца",
    "Созвездие Феникса",
    "Созвездие Часового",
    "Созвездие Аристократа"
}

-- Конфигурация шрифтов по умолчанию
local CONFIG = {
    fontSize = 14,
    fontName = "FRIZQT__", -- стандартный шрифт WoW
    fontPath = "Fonts\\FRIZQT__.TTF"
}

-- Доступные шрифты
local AVAILABLE_FONTS = {
    {name = "Стандартный (Friz Quadrata)", path = "Fonts\\FRIZQT__.TTF", key = "FRIZQT__"},
    {name = "Моноширинный (ARIALN)", path = "Fonts\\ARIALN.TTF", key = "ARIALN"},
    {name = "Skurri", path = "Fonts\\SKURRI.TTF", key = "SKURRI"},
    {name = "MORPHEUS", path = "Fonts\\MORPHEUS.TTF", key = "MORPHEUS"},
    {name = "FRIENDS", path = "Fonts\\FRIENDS.TTF", key = "FRIENDS"}
}

-- Загружаем сохраненные настройки
local function LoadSettings()
    if ConstellationsSettings then
        CONFIG.fontSize = ConstellationsSettings.fontSize or CONFIG.fontSize
        CONFIG.fontName = ConstellationsSettings.fontName or CONFIG.fontName
        CONFIG.fontPath = ConstellationsSettings.fontPath or CONFIG.fontPath
    end
end

-- Сохраняем настройки
local function SaveSettings()
    ConstellationsSettings = ConstellationsSettings or {}
    ConstellationsSettings.fontSize = CONFIG.fontSize
    ConstellationsSettings.fontName = CONFIG.fontName
    ConstellationsSettings.fontPath = CONFIG.fontPath
end

-- Функция для применения настроек шрифта ко всем элементам
local function ApplyFontSettings()
    if not ZodiakFrame then return end
    
    -- Обновляем описание
    if ZodiakFrame.descriptionText then
        ZodiakFrame.descriptionText:SetFont(CONFIG.fontPath, CONFIG.fontSize)
    end
    
    -- Обновляем заголовки
    if ZodiakFrame.detailTitle then
        ZodiakFrame.detailTitle:SetFont(CONFIG.fontPath, CONFIG.fontSize + 4) -- Заголовок на 4px больше
    end
    
    -- Обновляем текст кнопок созвездий
    if ZodiakFrame.constellationButtons then
        for _, btn in ipairs(ZodiakFrame.constellationButtons) do
            if btn.text then
                btn.text:SetFont(CONFIG.fontPath, 14, "OUTLINE") -- Фиксированный размер для кнопок
            end
        end
    end
    
    -- Обновляем текст кнопок способностей
    if ZodiakFrame.abilityButtons then
        for _, btn in ipairs(ZodiakFrame.abilityButtons) do
            if btn.text then
                btn.text:SetFont(CONFIG.fontPath, CONFIG.fontSize - 2) -- На 2px меньше основного
            end
        end
    end
    
    -- Обновляем текст союзных созвездий
    if ZodiakFrame.alliedButtons then
        for _, btn in ipairs(ZodiakFrame.alliedButtons) do
            if btn.text then
                btn.text:SetFont(CONFIG.fontPath, CONFIG.fontSize)
            end
        end
    end
    
    -- Обновляем ссылку на союзные созвездия
    if ZodiakFrame.alliedLink and ZodiakFrame.alliedLink.text then
        ZodiakFrame.alliedLink.text:SetFont(CONFIG.fontPath, 16)
    end
    
    -- Обновляем информационный текст
    if ZodiakFrame.afterText then
        ZodiakFrame.afterText:SetFont(CONFIG.fontPath, CONFIG.fontSize - 2)
    end
    
    -- Обновляем информационный текст союзных созвездий
    if ZodiakFrame.alliedInfoText then
        ZodiakFrame.alliedInfoText:SetFont(CONFIG.fontPath, 12)
    end
    
    -- Обновляем текст кнопок
    if ZodiakFrame.nextBtn then
        ZodiakFrame.nextBtn:SetNormalFontObject(GameFontNormal)
    end
    if ZodiakFrame.backBtn then
        ZodiakFrame.backBtn:SetNormalFontObject(GameFontNormal)
    end
    if ZodiakFrame.backToListBtn then
        ZodiakFrame.backToListBtn:SetNormalFontObject(GameFontNormal)
    end
end

-- Функция для обновления шрифта во всем аддоне
local function UpdateAllFonts()
    ApplyFontSettings()
    
    -- Если окно настроек открыто, обновляем предпросмотр
    if SettingsFrame and SettingsFrame:IsShown() then
        if SettingsFrame.previewText then
            SettingsFrame.previewText:SetFont(CONFIG.fontPath, CONFIG.fontSize)
            SettingsFrame.previewText:SetText("Пример текста с размером " .. CONFIG.fontSize .. "px\nи шрифтом " .. CONFIG.fontName)
        end
    end
end

-- Модифицированная функция GetZodiakFont для использования настроек
local function GetZodiakFont(size, flags)
    size = size or CONFIG.fontSize
    flags = flags or ""
    
    -- Используем настроенный шрифт
    local fontPath = CONFIG.fontPath
    
    -- Создаем таблицу с настройками шрифта
    local fontInfo = {
        size = size,
        flags = flags,
        path = fontPath
    }
    
    return fontInfo
end

-- Модифицированная функция ApplyFontToObject для применения шрифта
local function ApplyFontToObject(object, fontInfo)
    if not object or not fontInfo then return end
    
    if fontInfo.path then
        object:SetFont(fontInfo.path, fontInfo.size, fontInfo.flags)
    end
end

-- Создание окна настроек
local function CreateSettingsWindow()
    local frame = CreateFrame("Frame", "ConstellationsSettingsFrame", UIParent)
    frame:SetSize(400, 400)
    frame:Hide()
    
    -- Используем ту же текстуру, что и у основного окна, но меньшего размера
    frame.background = frame:CreateTexture(nil, "BACKGROUND")
    frame.background:SetAllPoints()
    frame.background:SetTexture("Interface\\AddOns\\Constellations\\Textures\\zodiak.blp")
    frame.background:SetTexCoord(0.05, 0.95, 0.05, 0.95) -- Немного обрезаем края
    
    -- Заголовок (перемещен вниз)
    frame.title = frame:CreateFontString(nil, "OVERLAY")
    frame.title:SetFont(CONFIG.fontPath, 20)
    frame.title:SetPoint("TOP", 0, -35) -- Было -25
    frame.title:SetText("Настройки шрифта")
    frame.title:SetTextColor(1, 0.8, 0) -- Оставляем оригинальный цвет
    frame.title:SetShadowColor(0, 0, 0, 1)
    frame.title:SetShadowOffset(2, -2)
    
    -- Настройка размера шрифта (перемещен вниз)
    frame.fontSizeLabel = frame:CreateFontString(nil, "OVERLAY")
    frame.fontSizeLabel:SetFont(CONFIG.fontPath, 14)
    frame.fontSizeLabel:SetPoint("TOP", 0, -85) -- Было -70
    frame.fontSizeLabel:SetText("Размер шрифта: " .. CONFIG.fontSize .. "px")
    frame.fontSizeLabel:SetTextColor(0.2, 0.4, 1) -- Синий цвет
    frame.fontSizeLabel:SetShadowColor(0, 0, 0, 0.8)
    frame.fontSizeLabel:SetShadowOffset(1, -1)
    
    -- Ползунок для размера шрифта (перемещен вниз)
    frame.fontSizeSlider = CreateFrame("Slider", nil, frame, "OptionsSliderTemplate")
    frame.fontSizeSlider:SetWidth(250)
    frame.fontSizeSlider:SetHeight(20)
    frame.fontSizeSlider:SetPoint("TOP", 0, -115) -- Было -100
    frame.fontSizeSlider:SetMinMaxValues(8, 24)
    frame.fontSizeSlider:SetValueStep(1)
    frame.fontSizeSlider:SetValue(CONFIG.fontSize)
    
    -- Подписи к ползунку
    for _, child in ipairs({frame.fontSizeSlider:GetChildren()}) do
        local childName = child:GetName() or ""
        if childName:find("Low$") then
            frame.fontSizeSlider.low = child
            child:SetText("8")
            child:SetTextColor(0.2, 0.4, 1) -- Синий цвет
        elseif childName:find("High$") then
            frame.fontSizeSlider.high = child
            child:SetText("24")
            child:SetTextColor(0.2, 0.4, 1) -- Синий цвет
        elseif childName:find("Text$") then
            frame.fontSizeSlider.text = child
            child:SetText("Размер: " .. CONFIG.fontSize)
            child:SetTextColor(0.2, 0.4, 1) -- Синий цвет
            child:SetShadowColor(0, 0, 0, 0.8)
            child:SetShadowOffset(1, -1)
        end
    end
    
    -- Альтернативный, более простой способ, если выше не работает:
    if not frame.fontSizeSlider.text then
        frame.fontSizeSlider.text = frame.fontSizeSlider:CreateFontString(nil, "OVERLAY", "GameFontNormal")
        frame.fontSizeSlider.text:SetPoint("TOP", frame.fontSizeSlider, "BOTTOM", 0, -8)
        frame.fontSizeSlider.text:SetText("Размер: " .. CONFIG.fontSize)
        frame.fontSizeSlider.text:SetTextColor(0.2, 0.4, 1) -- Синий цвет
        frame.fontSizeSlider.text:SetShadowColor(0, 0, 0, 0.8)
        frame.fontSizeSlider.text:SetShadowOffset(1, -1)
    end
    
    -- Настройка выбора шрифта (перемещен вниз)
    frame.fontSelectLabel = frame:CreateFontString(nil, "OVERLAY")
    frame.fontSelectLabel:SetFont(CONFIG.fontPath, 14)
    frame.fontSelectLabel:SetPoint("TOP", 0, -155) -- Было -140
    frame.fontSelectLabel:SetText("Выбор шрифта:")
    frame.fontSelectLabel:SetTextColor(0.2, 0.4, 1) -- Синий цвет
    frame.fontSelectLabel:SetShadowColor(0, 0, 0, 0.8)
    frame.fontSelectLabel:SetShadowOffset(1, -1)
    
    -- Выпадающий список для выбора шрифта (перемещен вниз)
    frame.fontSelect = CreateFrame("Frame", "ConstellationsFontSelect", frame, "UIDropDownMenuTemplate")
    frame.fontSelect:SetPoint("TOP", 0, -180) -- Было -165
    frame.fontSelect:SetSize(200, 32)
    
    -- Стилизуем кнопку выпадающего списка
    local fontSelectButton = _G["ConstellationsFontSelectButton"]
    if fontSelectButton then
        fontSelectButton:SetNormalFontObject(GameFontNormal)
        fontSelectButton:SetHighlightFontObject(GameFontHighlight)
        fontSelectButton.text = fontSelectButton:GetFontString()
        if fontSelectButton.text then
            fontSelectButton.text:SetTextColor(0.2, 0.4, 1) -- Синий цвет
            fontSelectButton.text:SetShadowColor(0, 0, 0, 0.8)
            fontSelectButton.text:SetShadowOffset(1, -1)
        end
    end
    
    local function FontSelect_OnClick(self, arg1, arg2, checked)
        CONFIG.fontName = arg1
        CONFIG.fontPath = arg2
        UIDropDownMenu_SetText(frame.fontSelect, self:GetText())
        SaveSettings()
        UpdateAllFonts()
    end
    
    local function FontSelect_Initialize()
        local info = UIDropDownMenu_CreateInfo()
        for _, font in ipairs(AVAILABLE_FONTS) do
            info.text = font.name
            info.arg1 = font.key
            info.arg2 = font.path
            info.func = FontSelect_OnClick
            info.checked = (CONFIG.fontName == font.key)
            info.fontObject = GameFontNormal
            info.textR = 0.2
            info.textG = 0.4
            info.textB = 1
            UIDropDownMenu_AddButton(info)
        end
    end
    
    UIDropDownMenu_Initialize(frame.fontSelect, FontSelect_Initialize)
    UIDropDownMenu_SetWidth(frame.fontSelect, 200)
    UIDropDownMenu_SetText(frame.fontSelect, "Выберите шрифт")
    
    -- Обновляем текст выпадающего списка
    for _, font in ipairs(AVAILABLE_FONTS) do
        if font.key == CONFIG.fontName then
            UIDropDownMenu_SetText(frame.fontSelect, font.name)
            break
        end
    end
    
    -- Предпросмотр шрифта (перемещен вниз)
    frame.previewLabel = frame:CreateFontString(nil, "OVERLAY")
    frame.previewLabel:SetFont(CONFIG.fontPath, 14)
    frame.previewLabel:SetPoint("TOP", 0, -225) -- Было -210
    frame.previewLabel:SetText("Предпросмотр:")
    frame.previewLabel:SetTextColor(0.2, 0.4, 1) -- Синий цвет
    frame.previewLabel:SetShadowColor(0, 0, 0, 0.8)
    frame.previewLabel:SetShadowOffset(1, -1)
    
    frame.previewText = frame:CreateFontString(nil, "OVERLAY")
    frame.previewText:SetFont(CONFIG.fontPath, CONFIG.fontSize)
    frame.previewText:SetPoint("TOP", 0, -250) -- Было -235
    frame.previewText:SetWidth(360)
    frame.previewText:SetJustifyH("CENTER") -- Центрируем текст
    frame.previewText:SetText("Пример текста с размером " .. CONFIG.fontSize .. "px\nи шрифтом " .. CONFIG.fontName)
    frame.previewText:SetTextColor(0.2, 0.4, 1) -- Синий цвет
    frame.previewText:SetShadowColor(0, 0, 0, 0.8)
    frame.previewText:SetShadowOffset(1, -1)
    
    -- Кнопка закрытия (поднята вверх от низа)
    frame.closeBtn = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.closeBtn:SetSize(120, 30)
    frame.closeBtn:SetPoint("BOTTOM", 0, 40) -- Было 30
    frame.closeBtn:SetText("Закрыть")
    frame.closeBtn:SetNormalFontObject(GameFontNormal)
    frame.closeBtn:SetHighlightFontObject(GameFontHighlight)
    
    -- Стилизуем текст кнопки
    frame.closeBtn.text = frame.closeBtn:GetFontString()
    if frame.closeBtn.text then
        frame.closeBtn.text:SetTextColor(0.2, 0.4, 1) -- Синий цвет
        frame.closeBtn.text:SetShadowColor(0, 0, 0, 0.8)
        frame.closeBtn.text:SetShadowOffset(1, -1)
    end
    
    frame.closeBtn:SetScript("OnClick", function()
        frame:Hide()
    end)
    
    -- Кнопка сброса настроек
    frame.resetBtn = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.resetBtn:SetSize(120, 30)
    frame.resetBtn:SetPoint("RIGHT", frame.closeBtn, "LEFT", -15, 0)
    frame.resetBtn:SetText("Сбросить")
    frame.resetBtn:SetNormalFontObject(GameFontNormal)
    frame.resetBtn:SetHighlightFontObject(GameFontHighlight)
    
    -- Стилизуем текст кнопки
    frame.resetBtn.text = frame.resetBtn:GetFontString()
    if frame.resetBtn.text then
        frame.resetBtn.text:SetTextColor(0.2, 0.4, 1) -- Синий цвет
        frame.resetBtn.text:SetShadowColor(0, 0, 0, 0.8)
        frame.resetBtn.text:SetShadowOffset(1, -1)
    end
    
    frame.resetBtn:SetScript("OnClick", function()
        CONFIG.fontSize = 14
        CONFIG.fontName = "FRIZQT__"
        CONFIG.fontPath = "Fonts\\FRIZQT__.TTF"
        SaveSettings()
        UpdateAllFonts()
        
        -- Обновляем элементы управления
        frame.fontSizeSlider:SetValue(CONFIG.fontSize)
        frame.fontSizeSlider.text:SetText("Размер: " .. CONFIG.fontSize)
        frame.fontSizeLabel:SetText("Размер шрифта: " .. CONFIG.fontSize .. "px")
        UIDropDownMenu_SetText(frame.fontSelect, "Стандартный (Friz Quadrata)")
    end)
    
    -- Кнопка применения
    frame.applyBtn = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.applyBtn:SetSize(120, 30)
    frame.applyBtn:SetPoint("LEFT", frame.closeBtn, "RIGHT", 15, 0)
    frame.applyBtn:SetText("Применить")
    frame.applyBtn:SetNormalFontObject(GameFontNormal)
    frame.applyBtn:SetHighlightFontObject(GameFontHighlight)
    
    -- Стилизуем текст кнопки
    frame.applyBtn.text = frame.applyBtn:GetFontString()
    if frame.applyBtn.text then
        frame.applyBtn.text:SetTextColor(0.2, 0.4, 1) -- Синий цвет
        frame.applyBtn.text:SetShadowColor(0, 0, 0, 0.8)
        frame.applyBtn.text:SetShadowOffset(1, -1)
    end
    
    frame.applyBtn:SetScript("OnClick", function()
        SaveSettings()
        UpdateAllFonts()
    end)
    
    -- Обработчик изменения ползунка
    frame.fontSizeSlider:SetScript("OnValueChanged", function(self, value)
        CONFIG.fontSize = math.floor(value)
        frame.fontSizeSlider.text:SetText("Размер: " .. CONFIG.fontSize)
        frame.fontSizeLabel:SetText("Размер шрифта: " .. CONFIG.fontSize .. "px")
        
        -- Обновляем предпросмотр
        frame.previewText:SetFont(CONFIG.fontPath, CONFIG.fontSize)
        frame.previewText:SetText("Пример текста с размером " .. CONFIG.fontSize .. "px\nи шрифтом " .. CONFIG.fontName)
    end)
    
    -- Функция для обновления позиции окна настроек
    local function UpdateSettingsFramePosition()
        if ZodiakFrame and ZodiakFrame:IsShown() then
            -- Позиционируем справа от основного окна
            frame:ClearAllPoints()
            frame:SetPoint("LEFT", ZodiakFrame, "RIGHT", 10, 0)
        end
    end
    
    -- Функция для привязки движения основного окна
    local function HookZodiakFrameMovement()
        if ZodiakFrame then
            -- Сохраняем оригинальные функции
            local originalStartMoving = ZodiakFrame.StartMoving
            local originalStopMoving = ZodiakFrame.StopMovingOrSizing
            
            -- Переопределяем StartMoving
            ZodiakFrame.StartMoving = function(self)
                if originalStartMoving then
                    originalStartMoving(self)
                end
                -- Если окно настроек открыто, перемещаем его тоже
                if frame:IsShown() then
                    frame:StartMoving()
                end
            end
            
            -- Переопределяем StopMovingOrSizing
            ZodiakFrame.StopMovingOrSizing = function(self)
                if originalStopMoving then
                    originalStopMoving(self)
                end
                -- Останавливаем движение окна настроек
                if frame:IsShown() then
                    frame:StopMovingOrSizing()
                    -- Обновляем позицию относительно основного окна
                    UpdateSettingsFramePosition()
                end
            end
        end
    end
    
    -- Обработчики событий
    frame:SetScript("OnShow", function()
        UpdateAllFonts()
        UpdateSettingsFramePosition()
        -- Привязываем движение к основному окну при открытии
        HookZodiakFrameMovement()
        
        -- Обновляем цвета всех текстовых элементов при открытии
        -- Заголовок остается с оригинальным цветом
        frame.fontSizeLabel:SetTextColor(0.2, 0.4, 1)
        frame.fontSelectLabel:SetTextColor(0.2, 0.4, 1)
        frame.previewLabel:SetTextColor(0.2, 0.4, 1)
        frame.previewText:SetTextColor(0.2, 0.4, 1)
        
        if frame.fontSizeSlider.text then
            frame.fontSizeSlider.text:SetTextColor(0.2, 0.4, 1)
        end
        
        -- Обновляем текст кнопок
        if frame.closeBtn.text then
            frame.closeBtn.text:SetTextColor(0.2, 0.4, 1)
        end
        if frame.resetBtn.text then
            frame.resetBtn.text:SetTextColor(0.2, 0.4, 1)
        end
        if frame.applyBtn.text then
            frame.applyBtn.text:SetTextColor(0.2, 0.4, 1)
        end
        
        -- Обновляем выпадающий список
        local fontSelectButton = _G["ConstellationsFontSelectButton"]
        if fontSelectButton and fontSelectButton.text then
            fontSelectButton.text:SetTextColor(0.2, 0.4, 1)
        end
        
        -- Обновляем подписи ползунка
        if frame.fontSizeSlider.low then
            frame.fontSizeSlider.low:SetTextColor(0.2, 0.4, 1)
        end
        if frame.fontSizeSlider.high then
            frame.fontSizeSlider.high:SetTextColor(0.2, 0.4, 1)
        end
    end)
    
    -- Закрываем окно настроек при закрытии основного окна
    if ZodiakFrame then
        ZodiakFrame:HookScript("OnHide", function()
            frame:Hide()
        end)
    end
    
    SettingsFrame = frame
    return frame
end

-- ========== ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ==========
local function AddWrappedLine(tooltip, text, r, g, b, wrapWidth)
    wrapWidth = wrapWidth or 40
    if not text or text == "" then return end
    local words = {}
    for word in text:gmatch("%S+") do
        table.insert(words, word)
    end

    local line = ""
    for _, word in ipairs(words) do
        local testLine = line .. (line == "" and "" or " ") .. word
        if #testLine > wrapWidth then
            tooltip:AddLine(line, r, g, b)
            line = word
        else
            line = testLine
        end
    end
    if line ~= "" then
        tooltip:AddLine(line, r, g, b)
    end
end

-- ========== ОСНОВНЫЕ ФУНКЦИИ ==========
local function CreateMinimapButton()
    local button = CreateFrame("Button", "ConstellationsMinimapButton", Minimap)
    button:SetSize(32, 32)
    button:SetFrameStrata("HIGH")
    
    local icon = button:CreateTexture(nil, "BACKGROUND")
    icon:SetTexture("Interface\\Icons\\Spell_Nature_StarFall")
    icon:SetAllPoints()
    button.icon = icon
    
    button:SetHighlightTexture("Interface\\Minimap\\UI-Minimap-ZoomButton-Highlight")
    button:SetPoint("TOPLEFT", Minimap, "TOPLEFT", -10, -10)
    
    button:SetMovable(true)
    button:RegisterForDrag("LeftButton")
    button:SetScript("OnDragStart", function(self)
        self.isMoving = true
        self:StartMoving()
    end)
    button:SetScript("OnDragStop", function(self)
        if self.isMoving then
            self:StopMovingOrSizing()
            self.isMoving = false
        end
    end)
    
    button:SetScript("OnClick", function(self, buttonClicked)
        if buttonClicked == "LeftButton" then
            if not ZodiakFrame or not ZodiakFrame:IsShown() then
                ShowZodiakFrame("description")
            else
                ZodiakFrame:Hide()
            end
        end
    end)
    
    button:SetScript("OnEnter", function(self)
        GameTooltip:SetOwner(self, "ANCHOR_LEFT")
        GameTooltip:SetText("Созвездия")
        GameTooltip:AddLine("ЛКМ - открыть созвездия", 0.8, 0.8, 0.8)
        GameTooltip:Show()
    end)
    
    button:SetScript("OnLeave", function()
        GameTooltip:Hide()
    end)
    
    return button
end

function HideAllElements()
    if not ZodiakFrame then return end
    
    ZodiakFrame.nextBtn:Hide()
    ZodiakFrame.backBtn:Hide()
    ZodiakFrame.backToListBtn:Hide()
    
    if ZodiakFrame.descriptionScrollFrame then
        ZodiakFrame.descriptionScrollFrame:Hide()
    end
    
    if ZodiakFrame.constellationButtons then
        for _, btn in ipairs(ZodiakFrame.constellationButtons) do
            btn:Hide()
        end
    end
    
    if ZodiakFrame.alliedButtons then
        for _, btn in ipairs(ZodiakFrame.alliedButtons) do
            btn:Hide()
        end
    end
    
    if ZodiakFrame.alliedInfoText then
        ZodiakFrame.alliedInfoText:Hide()
    end
    
    if ZodiakFrame.alliedLink then
        ZodiakFrame.alliedLink:Hide()
    end
    
    if ZodiakFrame.afterText then
        ZodiakFrame.afterText:Hide()
    end
    
    if ZodiakFrame.detailIcon then
        ZodiakFrame.detailIcon:SetTexture(nil)
        ZodiakFrame.detailIcon:Hide()
        ZodiakFrame.detailIcon:SetPoint("TOP", 0, -20) -- Сбрасываем позицию
        ZodiakFrame.detailIcon:SetSize(256, 256) -- Сбрасываем размер
    end
    if ZodiakFrame.detailTitle then
        ZodiakFrame.detailTitle:Hide()
        ZodiakFrame.detailTitle:SetPoint("TOP", 0, -200) -- Сбрасываем позицию
    end
    if ZodiakFrame.abilitiesFrame then
        ZodiakFrame.abilitiesFrame:Hide()
    end
    if ZodiakFrame.abilitiesScrollFrame then
        ZodiakFrame.abilitiesScrollFrame:Hide()
    end
    if ZodiakFrame.abilityButtons then
        for _, btn in ipairs(ZodiakFrame.abilityButtons) do
            btn:Hide()
        end
    end
end

function ShowDescriptionMode()
    if not ZodiakFrame then return end
    
    -- Очищаем предыдущий текст
    ZodiakFrame.descriptionText:SetText("")
    
    local descriptionText = [[|cFFFF0000Что такое созвездия?|r

|cFFD2691EСозвездия - это система, которая определяет уникальные способности персонажа. В отличие от расы, которая влияет только на внешность, выбор созвездия даёт персонажу дополнительные активные и пассивные способности. Каждое созвездие имеет свои особенности и подходит для разных стилей игры и ролей в персонаже.|r

|cFFA52A2AТакже в списке вы сможете увидеть ещё шесть закрытых созвездий. Это наследие великих союзных рас. Чтобы открыть доступ к интересующему вам созвездию, вам потребуется достичь высокой репутации с расой, которая находится под его покровительством.|r]]


    -- Устанавливаем текст
    ZodiakFrame.descriptionText:SetText(descriptionText)
    
    -- Используем настроенный шрифт
    local fontInfo = GetZodiakFont(CONFIG.fontSize)
    ApplyFontToObject(ZodiakFrame.descriptionText, fontInfo)
    
    -- Устанавливаем межстрочный интервал
    ZodiakFrame.descriptionText:SetSpacing(8)
    
    -- Пересчитываем высоту текста после изменения шрифта
    ZodiakFrame.descriptionText:SetWidth(310)
    local textHeight = ZodiakFrame.descriptionText:GetHeight()
    
    -- Удаляем старый текст, если он есть
    if ZodiakFrame.afterText then
        ZodiakFrame.afterText:Hide()
    end
    
    -- Корректируем высоту скролла на основе текста
    ZodiakFrame.descriptionScrollChild:SetHeight(textHeight + 100)
    
    -- Создаем или обновляем кликабельную ссылку для союзных созвездий
    if not ZodiakFrame.alliedLink then
        ZodiakFrame.alliedLink = CreateFrame("Button", nil, ZodiakFrame.descriptionScrollChild)
        ZodiakFrame.alliedLink:SetSize(300, 25)
        ZodiakFrame.alliedLink:SetPoint("TOP", ZodiakFrame.descriptionScrollChild, "TOP", 0, -textHeight - 20)
        
        local linkText = ZodiakFrame.alliedLink:CreateFontString(nil, "OVERLAY")
        linkText:SetFont(CONFIG.fontPath, 16)
        linkText:SetPoint("CENTER", 0, 0)
        linkText:SetJustifyH("CENTER")
        linkText:SetText("|cFFFF0000СОЮЗНЫЕ СОЗВЕЗДИЯ|r")
        ZodiakFrame.alliedLink.text = linkText
        
        local highlight = ZodiakFrame.alliedLink:CreateTexture(nil, "HIGHLIGHT")
        highlight:SetTexture("Interface\\QuestFrame\\UI-QuestTitleHighlight")
        highlight:SetBlendMode("ADD")
        highlight:SetAllPoints()
        
        ZodiakFrame.alliedLink:SetScript("OnEnter", function(self)
            self.text:SetTextColor(1, 1, 0)
        end)
        
        ZodiakFrame.alliedLink:SetScript("OnLeave", function(self)
            self.text:SetTextColor(1, 0.6, 0)
        end)
        
        ZodiakFrame.alliedLink:SetScript("OnClick", function()
            ShowAlliedConstellationsWindow()
        end)
    else
        ZodiakFrame.alliedLink:SetPoint("TOP", ZodiakFrame.descriptionScrollChild, "TOP", 0, -textHeight - 20)
        -- Обновляем шрифт существующей ссылки
        ZodiakFrame.alliedLink.text:SetFont(CONFIG.fontPath, 16)
    end
    
    ZodiakFrame.alliedLink:Show()
    
    -- Создаем или обновляем текст после кнопки
    if not ZodiakFrame.afterText then
        ZodiakFrame.afterText = ZodiakFrame.descriptionScrollChild:CreateFontString(nil, "OVERLAY")
        local afterFontInfo = GetZodiakFont(CONFIG.fontSize - 2)
        ApplyFontToObject(ZodiakFrame.afterText, afterFontInfo)
        ZodiakFrame.afterText:SetPoint("TOP", ZodiakFrame.descriptionScrollChild, "TOP", 0, -textHeight - 50)
        ZodiakFrame.afterText:SetWidth(310)
        ZodiakFrame.afterText:SetJustifyH("CENTER")
    else
        local afterFontInfo = GetZodiakFont(CONFIG.fontSize - 2)
        ApplyFontToObject(ZodiakFrame.afterText, afterFontInfo)
        ZodiakFrame.afterText:SetPoint("TOP", ZodiakFrame.descriptionScrollChild, "TOP", 0, -textHeight - 50)
    end
    
    ZodiakFrame.afterText:SetText([[|cFF333333Узнать расположение представительств союзных рас можно на информационной доске (например, в Даларане) или обратившись к стражникам в вашем городе.|r]])
    ZodiakFrame.afterText:Show()
    
    -- Обновляем высоту скроллчарда с учетом всех элементов
    local totalHeight = textHeight + 100 + ZodiakFrame.afterText:GetHeight()
    ZodiakFrame.descriptionScrollChild:SetHeight(totalHeight)
    ZodiakFrame.descriptionScrollFrame:Show()
    
    ZodiakFrame.nextBtn:SetScript("OnClick", function()
        ShowZodiakFrame("list")
    end)
    ZodiakFrame.nextBtn:Show()
end

function ShowAlliedConstellationsWindow()
    if not ZodiakFrame then return end
    
    HideAllElements()
    
    if not ZodiakFrame.alliedButtons then
        CreateAlliedConstellationButtons()
    end
    
    for _, btn in ipairs(ZodiakFrame.alliedButtons) do
        btn:Show()
    end
    
    if ZodiakFrame.alliedInfoText then
        ZodiakFrame.alliedInfoText:Show()
    end
    
    -- Сохраняем текущий режим
    ZodiakFrame.currentMode = "allied"
    
    ZodiakFrame.backBtn:SetScript("OnClick", function()
        ShowZodiakFrame("description")
    end)
    ZodiakFrame.backBtn:Show()
end

function CreateAlliedConstellationButtons()
    if not ZodiakFrame then return end
    
    local alliedConstellations = {
        {name = "Безликого", race = "Эльфы Бездны"},
        {name = "Магистра", race = "Ночнорожденные"},
        {name = "Демона", race = "Эредары"},
        {name = "Ящера", race = "Зандалары"},
        {name = "Наару", race = "Озаренные Дренеи"},
        {name = "Вулкана", race = "Дворфы Черного Железа"}
    }
    
    ZodiakFrame.alliedButtons = {}
    
    for i, constellation in ipairs(alliedConstellations) do
        local btn = CreateFrame("Button", nil, ZodiakFrame.contentArea)
        btn:SetSize(280, 30)
        btn:SetPoint("TOP", 0, -120 - (i-1) * 35)
        
        local text = btn:CreateFontString(nil, "OVERLAY")
        text:SetFont(CONFIG.fontPath, CONFIG.fontSize)
        text:SetPoint("LEFT", 0, 0)
        text:SetJustifyH("LEFT")
        text:SetText("Созвездие " .. constellation.name .. " - (" .. constellation.race .. ")")
        text:SetTextColor(0.0, 0.2, 0.8)
        btn.text = text
        
        local highlight = btn:CreateTexture(nil, "HIGHLIGHT")
        highlight:SetTexture("Interface\\QuestFrame\\UI-QuestTitleHighlight")
        highlight:SetBlendMode("ADD")
        highlight:SetAllPoints()
        
        btn:SetScript("OnEnter", function(self)
            self.text:SetTextColor(1.0, 0.4, 0.7)
        end)
        
        btn:SetScript("OnLeave", function(self)
            self.text:SetTextColor(0.0, 0.2, 0.8)
        end)
        
        btn:SetScript("OnClick", function()
            if CONSTELLATIONS_DATA[constellation.name] then
                ShowConstellationDetails(constellation.name)
            else
                print("|cFFFF0000Созвездие '" .. constellation.name .. "' пока не реализовано.|r")
            end
        end)
        
        table.insert(ZodiakFrame.alliedButtons, btn)
    end
    
    -- Добавляем текст с информацией о репутации
    if not ZodiakFrame.alliedInfoText then
        ZodiakFrame.alliedInfoText = ZodiakFrame.contentArea:CreateFontString(nil, "OVERLAY")
        ZodiakFrame.alliedInfoText:SetFont(CONFIG.fontPath, 12)
        ZodiakFrame.alliedInfoText:SetPoint("BOTTOM", 0, 30)
        ZodiakFrame.alliedInfoText:SetWidth(300)
        ZodiakFrame.alliedInfoText:SetJustifyH("CENTER")
        ZodiakFrame.alliedInfoText:SetText("|cFF8B4513Для открытия доступа к созвездию требуется достичь высокой репутации с соответствующей союзной расой.|r")
    end
end

function ShowConstellationListMode()
    if not ZodiakFrame then return end
    
    ZodiakFrame.descriptionScrollFrame:Hide()
    if ZodiakFrame.afterText then
        ZodiakFrame.afterText:Hide()
    end
    
    if ZodiakFrame.alliedLink then
        ZodiakFrame.alliedLink:Hide()
    end
    
    if #ZodiakFrame.constellationButtons == 0 then
        CreateConstellationButtons()
    end
    
    for _, btn in ipairs(ZodiakFrame.constellationButtons) do
        btn:Show()
    end
    
    ZodiakFrame.backBtn:SetScript("OnClick", function()
        ShowZodiakFrame("description")
    end)
    ZodiakFrame.backBtn:Show()
end

function ShowConstellationDetails(constellationName)
    if not ZodiakFrame then return end
    
    local data = CONSTELLATIONS_DATA[constellationName]
    if not data then return end
    
    HideAllElements()
    
    if not ZodiakFrame.detailElements then
        CreateDetailElements()
    end
    
    UpdateDetailElements(constellationName, data)
    
    ZodiakFrame.detailIcon:Show()
    ZodiakFrame.detailTitle:Show()
    ZodiakFrame.backToListBtn:Show()
    
    -- Запоминаем, откуда мы пришли (союзные или обычные созвездия)
    local isAllied = false
    local alliedConstellations = {
        "Безликого", "Вулкана", "Демона", "Магистра", "Наару", "Ящера"
    }
    
    for _, alliedName in ipairs(alliedConstellations) do
        if constellationName == alliedName then
            isAllied = true
            break
        end
    end
    
    -- Сохраняем информацию о текущем режиме
    ZodiakFrame.currentMode = isAllied and "allied" or "list"
    
    -- Меняем текст кнопки в зависимости от типа созвездия
    if isAllied then
        ZodiakFrame.backToListBtn:SetText("Назад к союзным созвездиям")
    else
        ZodiakFrame.backToListBtn:SetText("Назад к списку созвездий")
    end
    
    ZodiakFrame.backToListBtn:SetScript("OnClick", function()
        if ZodiakFrame.currentMode == "allied" then
            -- Возвращаемся к списку союзных созвездий
            ShowAlliedConstellationsWindow()
        else
            -- Возвращаемся к общему списку созвездий
            ShowZodiakFrame("list")
        end
    end)
    
    if ZodiakFrame.abilitiesFrame then
        ZodiakFrame.abilitiesFrame:Show()
    end
end

function CreateConstellationButtons()
    if not ZodiakFrame then return end
    
    local radius = 160
    local angleStep = 2 * math.pi / #CONSTELLATIONS_LIST
    
    for i, constellationName in ipairs(CONSTELLATIONS_LIST) do
        local btn = CreateFrame("Button", nil, ZodiakFrame.contentArea)
        btn:SetSize(50, 50)
        
        local angle = (i - 1) * angleStep
        local x = radius * math.cos(angle)
        local y = radius * math.sin(angle)
        btn:SetPoint("CENTER", x, y)
        
        local bg = btn:CreateTexture(nil, "BACKGROUND")
        bg:SetAllPoints()
        bg:SetTexture("Interface\\AddOns\\Constellations\\Textures\\constellation_bg.blp")
        bg:SetAlpha(0.8)
        btn.bg = bg
        
        local btnText = btn:CreateFontString(nil, "OVERLAY")
        
        -- Используем настроенный шрифт для текста кнопок
        btnText:SetFont(CONFIG.fontPath, 14, "OUTLINE")
        btnText:SetPoint("CENTER", 0, 0)
        btnText:SetText(constellationName:match("Созвездие (.+)") or constellationName)
        btnText:SetTextColor(1, 0.95, 0.3)
        btnText:SetShadowColor(0, 0, 0, 1)
        btnText:SetShadowOffset(2, -2)
        btn.text = btnText
        
        local highlight = btn:CreateTexture(nil, "HIGHLIGHT")
        highlight:SetTexture("Interface\\Buttons\\UI-Common-MouseHilight")
        highlight:SetBlendMode("ADD")
        highlight:SetAllPoints()
        
        local glow = btn:CreateTexture(nil, "OVERLAY")
        glow:SetTexture("Interface\\SpellActivationOverlay\\IconAlert")
        glow:SetBlendMode("ADD")
        glow:SetAllPoints()
        glow:SetAlpha(0)
        btn.glow = glow
        
        btn:SetScript("OnClick", function()
            local nameOnly = constellationName:gsub("Созвездие ", "")
            ShowConstellationDetails(nameOnly)
        end)
        
        btn:SetScript("OnEnter", function(self)
            GameTooltip:SetOwner(self, "ANCHOR_RIGHT")
            GameTooltip:SetText(constellationName, 1, 1, 0.5)
            
            local constellationKey = constellationName:gsub("Созвездие ", "")
            local data = CONSTELLATIONS_DATA[constellationKey]
            
            if data then
                if data.icon and data.icon ~= "" then
                    GameTooltip:AddTexture(data.icon)
                end
                
                if data.abilities then
                    local roles = {}
                    for _, ability in ipairs(data.abilities) do
                        if not roles[ability.role] then
                            roles[ability.role] = true
                        end
                    end
                    
                    local roleList = {}
                    for role in pairs(roles) do
                        table.insert(roleList, role)
                    end
                    
                    GameTooltip:AddLine("Роли: " .. table.concat(roleList, ", "), 0.8, 0.8, 0.8)
                end
                
                GameTooltip:AddLine(" ")
                GameTooltip:AddLine("ЛКМ - посмотреть способности", 0.6, 0.8, 0.6)
            else
                GameTooltip:AddLine(" ")
                GameTooltip:AddLine("|cFFFF0000Созвездие пока не реализовано|r", 1, 0.5, 0.5)
                GameTooltip:AddLine("ЛКМ - посмотреть информацию", 0.6, 0.8, 0.6)
            end
            
            GameTooltip:Show()
            
            self.glow:SetAlpha(0.8)
            self.bg:SetAlpha(1)
            self:SetSize(55, 55)
            self.text:SetTextColor(1, 1, 0)
        end)
        
        btn:SetScript("OnLeave", function(self)
            GameTooltip:Hide()
            self.glow:SetAlpha(0)
            self.bg:SetAlpha(0.8)
            self:SetSize(50, 50)
            self.text:SetTextColor(1, 0.95, 0.3)
        end)
        
        table.insert(ZodiakFrame.constellationButtons, btn)
    end
end

function CreateDetailElements()
    if not ZodiakFrame then return end
    
    ZodiakFrame.detailIcon = ZodiakFrame.contentArea:CreateTexture(nil, "ARTWORK")
    ZodiakFrame.detailIcon:SetSize(256, 256)
    ZodiakFrame.detailIcon:SetPoint("TOP", 0, -20)
    ZodiakFrame.detailIcon:SetTexCoord(0, 1, 0, 1)
    ZodiakFrame.detailIcon:Hide()
    
    ZodiakFrame.detailTitle = ZodiakFrame.contentArea:CreateFontString(nil, "OVERLAY")
    
    -- Установка стандартного шрифта для заголовка
    local titleFontInfo = GetZodiakFont(CONFIG.fontSize + 4, "")
    ApplyFontToObject(ZodiakFrame.detailTitle, titleFontInfo)
    
    ZodiakFrame.detailTitle:SetPoint("TOP", 0, -200)
    ZodiakFrame.detailTitle:SetJustifyH("CENTER")
    ZodiakFrame.detailTitle:SetTextColor(1, 0.8, 0)
    ZodiakFrame.detailTitle:SetShadowColor(0, 0, 0, 1)
    ZodiakFrame.detailTitle:SetShadowOffset(2, -2)
    ZodiakFrame.detailTitle:Hide()
    
    ZodiakFrame.abilitiesFrame = CreateFrame("Frame", nil, ZodiakFrame.contentArea)
    ZodiakFrame.abilitiesFrame:SetSize(200, 1)
    ZodiakFrame.abilitiesFrame:SetPoint("TOP", 0, -230)
    ZodiakFrame.abilitiesFrame:Hide()
    
    ZodiakFrame.abilityButtons = {}
    
    if ZodiakFrame.backToListBtn then
        ZodiakFrame.backToListBtn:SetScript("OnClick", function()
            ShowZodiakFrame("list")
        end)
    end
    
    ZodiakFrame.detailElements = true
end

function UpdateDetailElements(name, data)
    if not ZodiakFrame then return end
    
    if data.icon and data.icon ~= "" then
        ZodiakFrame.detailIcon:SetTexture(data.icon)
        if not ZodiakFrame.detailIcon:GetTexture() then
            ZodiakFrame.detailIcon:SetTexture("Interface\\Icons\\INV_Misc_QuestionMark")
        end
    else
        ZodiakFrame.detailIcon:SetTexture("Interface\\Icons\\INV_Misc_QuestionMark")
    end
    
    ZodiakFrame.detailTitle:SetText("Созвездие " .. name)
    
    -- Обновляем шрифт заголовка
    local titleFontInfo = GetZodiakFont(CONFIG.fontSize + 4)
    ApplyFontToObject(ZodiakFrame.detailTitle, titleFontInfo)
    
    if ZodiakFrame.abilityButtons then
        for _, btn in ipairs(ZodiakFrame.abilityButtons) do
            btn:Hide()
        end
    end
    ZodiakFrame.abilityButtons = {}
    
    -- Определяем, является ли созвездие союзным
    local isAllied = false
    local alliedConstellations = {
        "Безликого", "Вулкана", "Демона", "Магистра", "Наару", "Ящера"
    }
    
    for _, alliedName in ipairs(alliedConstellations) do
        if name == alliedName then
            isAllied = true
            break
        end
    end
    
    if data.abilities and #data.abilities > 0 then
        ZodiakFrame.abilitiesFrame:Show()
        
        -- Расчет высоты для фрейма способностей
        local abilitiesCount = #data.abilities
        local frameHeight = math.min(abilitiesCount * 30, 300)
        
        -- Разное позиционирование для союзных и основных созвездий
        if isAllied then
            -- ПОЗИЦИОНИРОВАНИЕ ДЛЯ СОЮЗНЫХ СОЗВЕЗДИЙ
            ZodiakFrame.abilitiesFrame:SetSize(220, frameHeight)
            ZodiakFrame.abilitiesFrame:SetPoint("TOP", -60, -80) -- Слева, выше
            
            -- Иконка справа
            ZodiakFrame.detailIcon:SetPoint("TOP", 100, -70) -- Справа, выше
            ZodiakFrame.detailIcon:SetSize(240, 240) -- Меньший размер
            
            -- Заголовок выше
            ZodiakFrame.detailTitle:SetPoint("TOP", 0, -50)
            
        else
            -- ПОЗИЦИОНИРОВАНИЕ ДЛЯ ОСНОВНЫХ СОЗВЕЗДИЙ
            ZodiakFrame.abilitiesFrame:SetSize(220, frameHeight)
            ZodiakFrame.abilitiesFrame:SetPoint("TOP", -80, -180) -- По центру, ниже
            
            -- Иконка по центру сверху
            ZodiakFrame.detailIcon:SetPoint("TOP", 100, -70) -- По центру сверху
            ZodiakFrame.detailIcon:SetSize(240, 240) -- Большой размер
            
            -- Заголовок под иконкой
            ZodiakFrame.detailTitle:SetPoint("TOP", -60, -50)
        end
        
        for i, ability in ipairs(data.abilities) do
            local abilityInfo = {
                name = ability.name,
                role = ability.role,
                spellID = ability.spellID,
                icon = ability.icon,
                description = ability.description
            }
            
            local btn = CreateFrame("Button", nil, ZodiakFrame.abilitiesFrame)
            btn:SetSize(200, 25)
            
            -- Разное позиционирование кнопок внутри фрейма
            if isAllied then
                btn:SetPoint("TOP", 0, -(i - 1) * 30)
            else
                btn:SetPoint("TOP", 0, -(i - 1) * 30)
            end
            
            local icon = btn:CreateTexture(nil, "BACKGROUND")
            icon:SetSize(20, 20)
            icon:SetPoint("LEFT", 5, 0)
            icon:SetTexture(abilityInfo.icon or "Interface\\Icons\\INV_Misc_QuestionMark")
            
            local btnText = btn:CreateFontString(nil, "OVERLAY")
            
            -- Используем настроенный шрифт для текста способностей
            local abilityFontInfo = GetZodiakFont(CONFIG.fontSize - 2)
            ApplyFontToObject(btnText, abilityFontInfo)
            
            btnText:SetPoint("LEFT", 30, 0)
            btnText:SetJustifyH("LEFT")
            btnText:SetText(abilityInfo.role .. " - " .. abilityInfo.name)
            btnText:SetTextColor(0.95, 0.95, 0.85)
            btnText:SetShadowColor(0, 0, 0, 1)
            btnText:SetShadowOffset(1, -1)
            
            local bg = btn:CreateTexture(nil, "BACKGROUND")
            bg:SetAllPoints()
            if isAllied then
                bg:SetGradientAlpha("VERTICAL", 0.2, 0.3, 0.2, 0.7, 0.4, 0.5, 0.4, 0.9) -- Зеленоватый для союзных
            else
                bg:SetGradientAlpha("VERTICAL", 0.2, 0.2, 0.3, 0.7, 0.4, 0.4, 0.5, 0.9) -- Синеватый для основных
            end
            
            btn:SetHighlightTexture("Interface\\QuestFrame\\UI-QuestTitleHighlight")
            
            btn:SetScript("OnEnter", function(self)
                GameTooltip:SetOwner(self, "ANCHOR_RIGHT")
                GameTooltip:SetText(abilityInfo.name, 1, 1, 0.5)
                GameTooltip:AddLine(" ")
                GameTooltip:AddLine("Роль: " .. abilityInfo.role, 0.8, 0.8, 0.8)
                
                if abilityInfo.icon and abilityInfo.icon ~= "" then
                    GameTooltip:AddTexture(abilityInfo.icon)
                end
                
                if abilityInfo.description then
                    GameTooltip:AddLine(" ")
                    local desc = abilityInfo.description:gsub("\\n", "\n")
                    for line in desc:gmatch("([^\n]+)") do
                        AddWrappedLine(GameTooltip, line, 1, 1, 1, 60)
                    end
                end
                
                GameTooltip:AddLine("ID: " .. abilityInfo.spellID, 0.5, 0.5, 0.5)
                GameTooltip:Show()
            end)
            
            btn:SetScript("OnLeave", function()
                GameTooltip:Hide()
            end)
            
            table.insert(ZodiakFrame.abilityButtons, btn)
        end
        
        -- Если способностей много, добавляем возможность скролла
        if abilitiesCount * 30 > 300 then
            if not ZodiakFrame.abilitiesScrollFrame then
                -- Создаем скролл фрейм для способностей
                local scrollFrame = CreateFrame("ScrollFrame", nil, ZodiakFrame.abilitiesFrame, "UIPanelScrollFrameTemplate")
                scrollFrame:SetSize(220, 300)
                scrollFrame:SetPoint("TOP", 0, 0)
                
                local scrollChild = CreateFrame("Frame")
                scrollChild:SetSize(200, abilitiesCount * 30)
                scrollFrame:SetScrollChild(scrollChild)
                
                -- Перемещаем кнопки в скроллчард
                for i, btn in ipairs(ZodiakFrame.abilityButtons) do
                    btn:SetParent(scrollChild)
                    btn:SetPoint("TOP", 0, -(i - 1) * 30)
                end
                
                ZodiakFrame.abilitiesScrollFrame = scrollFrame
            else
                ZodiakFrame.abilitiesScrollFrame:Show()
            end
        elseif ZodiakFrame.abilitiesScrollFrame then
            ZodiakFrame.abilitiesScrollFrame:Hide()
        end
    else
        ZodiakFrame.abilitiesFrame:Hide()
        -- Сбрасываем позиции элементов если нет способностей
        ZodiakFrame.detailIcon:SetPoint("TOP", 0, -20)
        ZodiakFrame.detailIcon:SetSize(256, 256)
        ZodiakFrame.detailTitle:SetPoint("TOP", 0, -200)
    end
end

function UpdateZodiakFrame(mode)
    if mode == "description" then
        ShowDescriptionMode()
    elseif mode == "list" then
        ShowConstellationListMode()
    end
end

-- ========== ГЛАВНОЕ ОКНО ==========
function ShowZodiakFrame(mode)
    if not ZodiakFrame then
        CreateZodiakFrame()
    end
    
    HideAllElements()
    ZodiakFrame:Show()
    
    -- Сохраняем текущий режим
    if mode == "list" then
        ZodiakFrame.currentMode = "list"
    elseif mode == "description" then
        ZodiakFrame.currentMode = "description"
    end
    
    UpdateZodiakFrame(mode or "description")
end

function GetCurrentMode()
    if not ZodiakFrame then return "description" end
    return ZodiakFrame.currentMode or "description"
end

function CreateZodiakFrame()
    local frame = CreateFrame("Frame", "ZodiakFrame", UIParent)
    frame:SetSize(512, 512)
    frame:SetPoint("CENTER", 0, 0)
    frame:Hide()

    frame.background = frame:CreateTexture(nil, "BACKGROUND")
    frame.background:SetAllPoints()
    frame.background:SetTexture("Interface\\AddOns\\Constellations\\Textures\\zodiak.blp")

    frame.contentArea = CreateFrame("Frame", nil, frame)
    frame.contentArea:SetSize(440, 440)
    frame.contentArea:SetPoint("CENTER", 0, 0)

    frame.descriptionScrollFrame = CreateFrame("ScrollFrame", nil, frame.contentArea, "UIPanelScrollFrameTemplate")
    frame.descriptionScrollFrame:SetSize(350, 300)
    frame.descriptionScrollFrame:SetPoint("TOP", 0, -50)
    frame.descriptionScrollFrame:Hide()
    
    frame.descriptionScrollChild = CreateFrame("Frame")
    frame.descriptionScrollChild:SetSize(330, 400)
    frame.descriptionScrollFrame:SetScrollChild(frame.descriptionScrollChild)

    frame.descriptionText = frame.descriptionScrollChild:CreateFontString(nil, "OVERLAY")
    
    -- Используем настроенный шрифт
    local fontInfo = GetZodiakFont(CONFIG.fontSize)
    ApplyFontToObject(frame.descriptionText, fontInfo)
    
    frame.descriptionText:SetPoint("TOPLEFT", 10, -10)
    frame.descriptionText:SetWidth(310)
    frame.descriptionText:SetJustifyH("LEFT")
    frame.descriptionText:SetJustifyV("TOP")
    frame.descriptionText:SetSpacing(5)
    frame.descriptionText:SetTextColor(1, 1, 1)

    frame.nextBtn = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.nextBtn:SetFrameStrata("HIGH")
    frame.nextBtn:SetFrameLevel(10)
    frame.nextBtn:SetSize(140, 30)
    frame.nextBtn:SetPoint("BOTTOM", 0, 30)
    frame.nextBtn:SetText("К созвездиям")
    
    -- Стилизация кнопки
    frame.nextBtn:SetNormalFontObject("GameFontNormal")
    frame.nextBtn:SetHighlightFontObject("GameFontHighlight")
    frame.nextBtn:SetDisabledFontObject("GameFontDisable")
    
    frame.nextBtn:Hide()

    frame.constellationButtons = {}

    frame.backBtn = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.backBtn:SetSize(80, 25)
    frame.backBtn:SetPoint("BOTTOM", 0, 30)
    frame.backBtn:SetText("Назад")
    frame.backBtn:Hide()

    frame.backToListBtn = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.backToListBtn:SetSize(140, 25)
    frame.backToListBtn:SetPoint("BOTTOM", 0, 50)
    frame.backToListBtn:SetText("Назад к списку")
    frame.backToListBtn:Hide()

    -- Кнопка закрытия
    local closeBtn = CreateFrame("Button", nil, frame, "UIPanelCloseButton")
    closeBtn:SetPoint("TOPRIGHT", -8, -8)
    closeBtn:SetScript("OnClick", function()
        frame:Hide()
    end)

    -- Кнопка настроек (новая кнопка слева от закрытия)
    local settingsBtn = CreateFrame("Button", nil, frame)
    settingsBtn:SetSize(32, 32)
    settingsBtn:SetPoint("RIGHT", closeBtn, "LEFT", -5, 0)
    
    local settingsIcon = settingsBtn:CreateTexture(nil, "OVERLAY")
    settingsIcon:SetAllPoints()
    settingsIcon:SetTexture("Interface\\GossipFrame\\BinderGossipIcon")
    
    settingsBtn:SetHighlightTexture("Interface\\Buttons\\UI-Common-MouseHilight", "ADD")
    settingsBtn:SetScript("OnClick", function()
        if not SettingsFrame then
            CreateSettingsWindow()
        end
        
        if SettingsFrame:IsShown() then
            SettingsFrame:Hide()
        else
            SettingsFrame:Show()
        end
    end)
    
    settingsBtn:SetScript("OnEnter", function(self)
        GameTooltip:SetOwner(self, "ANCHOR_LEFT")
        GameTooltip:SetText("Настройки шрифта")
        GameTooltip:AddLine("ЛКМ - открыть настройки шрифта", 0.8, 0.8, 0.8)
        GameTooltip:Show()
    end)
    
    settingsBtn:SetScript("OnLeave", function()
        GameTooltip:Hide()
    end)

    frame:EnableMouse(true)
    frame:SetMovable(true)
    frame:RegisterForDrag("LeftButton")
    frame:SetScript("OnDragStart", frame.StartMoving)
    frame:SetScript("OnDragStop", frame.StopMovingOrSizing)

    ZodiakFrame = frame
end

-- ========== ИНИЦИАЛИЗАЦИЯ ==========
local function InitializeAddon()
    -- Загружаем настройки
    LoadSettings()
    
    local minimapBtn = CreateMinimapButton()
    
    SLASH_CONSTELLATIONS1 = "/созвездия"
    SLASH_CONSTELLATIONS2 = "/constellations"
    SlashCmdList["CONSTELLATIONS"] = function(msg)
        if msg == "список" then
            ShowZodiakFrame("list")
        elseif msg == "описание" then
            ShowZodiakFrame("description")
        elseif msg == "настройки" or msg == "settings" then
            if not SettingsFrame then
                CreateSettingsWindow()
            end
            SettingsFrame:Show()
        else
            if ZodiakFrame and ZodiakFrame:IsShown() then
                ZodiakFrame:Hide()
            else
                ShowZodiakFrame("description")
            end
        end
    end
    
    -- Добавляем команду для настроек
    SLASH_CONSTELLATIONS3 = "/созвездиянастройки"
    SLASH_CONSTELLATIONS4 = "/constsettings"
    
    print("|cFF00FF00Аддон 'Созвездия' загружен.|r")
    print("|cFFFFFF00Команды:|r /созвездия или /constellations")
    print("|cFFFFFF00Настройки шрифта:|r /созвездиянастройки")
end

local frame = CreateFrame("Frame")
frame:RegisterEvent("PLAYER_LOGIN")
frame:SetScript("OnEvent", InitializeAddon)

-- Экспортируем функции для доступа из других аддонов (опционально)
Constellations = {
    ShowWindow = ShowZodiakFrame,
    ShowSettings = function()
        if not SettingsFrame then
            CreateSettingsWindow()
        end
        SettingsFrame:Show()
    end,
    GetConfig = function()
        return CONFIG
    end,
    UpdateFonts = UpdateAllFonts
}